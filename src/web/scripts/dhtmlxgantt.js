var ganttContestUrl="./contest/detail.action?contestId=";var ganttSoftwareContestUrl="./contest/detail.action?projectId=";var ganttProjectUrl="./currentProjectOverview.action";function GanttProjectInfo(a,b,c){this.Id=a;this.Name=b;this.StartDate=c;this.ParentTasks=[]}GanttProjectInfo.prototype.deleteTask=function(a){var b=this.getTaskById(a);if(b){if(!b.ParentTask){for(var i=0;i<this.ParentTasks.length;i++){if(this.ParentTasks[i].Id==a){if(this.ParentTasks[i].nextParentTask){if(this.ParentTasks[i].previousParentTask){this.ParentTasks[i].previousParentTask.nextParentTask=this.ParentTasks[i].nextParentTask;this.ParentTasks[i].nextParentTask.previousParentTask=this.ParentTasks[i].previousParentTask}else{this.ParentTasks[i].nextParentTask.previousParentTask=null}}else{if(this.ParentTasks[i].previousParentTask){this.ParentTasks[i].previousParentTask.nextParentTask=null}}this.ParentTasks[i]=null;this.ParentTasks.splice(i,1);break}}}else{var c=b.ParentTask;for(var i=0;i<c.ChildTasks.length;i++){if(c.ChildTasks[i].Id==a){if(c.ChildTasks[i].nextChildTask){if(c.ChildTasks[i].previousChildTask){c.ChildTasks[i].previousChildTask.nextChildTask=c.ChildTasks[i].nextChildTask;c.ChildTasks[i].nextChildTask.previousChildTask=c.ChildTasks[i].previousChildTask}else{c.ChildTasks[i].nextChildTask.previousChildTask=null}}else{if(c.ChildTasks[i].previousChildTask){c.ChildTasks[i].previousChildTask.nextChildTask=null}}c.ChildTasks[i]=null;c.ChildTasks.splice(i,1);break}}}}};GanttProjectInfo.prototype.addTask=function(a){this.ParentTasks.push(a);a.setProject(this)};GanttProjectInfo.prototype.getTaskById=function(a){for(var j=0;j<this.ParentTasks.length;j++){var b=this.getTaskByIdInTree(this.ParentTasks[j],a);if(b)return b}return null};GanttProjectInfo.prototype.getTaskByIdInTree=function(a,b){if(a.Id==b){return a}else{for(var i=0;i<a.ChildTasks.length;i++){if(a.ChildTasks[i].Id==b){return a.ChildTasks[i]}if(a.ChildTasks[i].ChildTasks.length>0){if(a.ChildTasks[i].ChildTasks.length>0){var c=this.getTaskByIdInTree(a.ChildTasks[i],b);if(c)return c}}}}return null};function GanttTaskInfo(a,b,c,d,e,f){this.Id=a;this.Name=b;this.EST=c;this.Duration=d;this.PercentCompleted=e;this.PredecessorTaskId=f;this.ChildTasks=[];this.ChildPredTasks=[];this.ParentTask=null;this.PredecessorTask=null;this.Project=null;this.nextChildTask=null;this.previousChildTask=null;this.nextParentTask=null;this.previousParentTask=null}GanttTaskInfo.prototype.addChildTask=function(a){this.ChildTasks.push(a);a.ParentTask=this};GanttTaskInfo.prototype.setProject=function(a){this.Project=a;for(var j=0;j<this.ChildTasks.length;j++){this.ChildTasks[j].setProject(a)}};function GanttTask(a,b,c){this.isTask=true;this.Chart=c;this.Project=b;this.TaskInfo=a;this.checkMove=false;this.checkResize=false;this.moveChild=false;this.maxPosXMove=-1;this.minPosXMove=-1;this.maxWidthResize=-1;this.minWidthResize=-1;this.posX=0;this.posY=0;this.MouseX=0;this.taskItemWidth=0;this.isHide=false;this._heightHideTasks=0;this._isOpen=true;this.descrTask=null;this.cTaskItem=null;this.cTaskNameItem=null;this.parentTask=null;this.predTask=null;this.childTask=[];this.childPredTask=[];this.nextChildTask=null;this.previousChildTask=null;this.nextParentTask=null;this.previousParentTask=null}function GanttProject(a,b){this.isProject=true;this.nextProject=null;this.previousProject=null;this.arrTasks=[];this.Project=b;this.Chart=a;this.percentCompleted=0;this.Duration=0;this.descrProject=null;this.projectItem=null;this.projectNameItem=null;this.posY=0;this.posX=0}GanttProject.prototype.checkWidthProjectNameItem=function(){var a=this.Project.Name;if(this.projectNameItem.offsetWidth+this.projectNameItem.offsetLeft>this.Chart.maxWidthPanelNames){var b=this.projectNameItem.offsetWidth+this.projectNameItem.offsetLeft-this.Chart.maxWidthPanelNames;var c=Math.round(b/(this.projectNameItem.offsetWidth/this.projectNameItem.firstChild.length));a=this.Project.Name.substring(0,this.projectNameItem.firstChild.length-c-3);a+="..."}this.projectNameItem.innerHTML="<a href=\""+ganttProjectUrl+"\">"+a+"</a>"};GanttProject.prototype.create=function(){var a=this.Chart.oData.firstChild;this.posX=(this.Project.StartDate-this.Chart.startDate)/(60*60*1000)*this.Chart.hourInPixels;if(this.previousProject){if(this.previousProject.arrTasks.length>0){var b=this.Chart.getLastChildTask(this.previousProject.arrTasks[this.previousProject.arrTasks.length-1]);this.posY=parseInt(b.cTaskItem[0].style.top)+this.Chart.heightTaskItem+11}else{this.posY=parseInt(this.previousProject.projectItem[0].style.top)+this.Chart.heightTaskItem+11}}else{this.posY=6}if(this.Chart._showTreePanel){var c=this.Chart.panelNames.firstChild;this.projectNameItem=this.createProjectNameItem();c.appendChild(this.projectNameItem);this.checkWidthProjectNameItem()}this.projectItem=[this.createProjectItem(),[]];a.appendChild(this.projectItem[0]);if(this.Chart.isShowDescProject){a.appendChild(this.createDescrProject())}this.addDayInPanelTime()};function GanttChart(){this.Error=new GanttError();this.dhtmlXMLSenderObject=new dhtmlXMLSenderObject(this);this.heightTaskItem=12;this.dayInPixels=24;this.hoursInDay=24;this._showTreePanel=true;this._showTooltip=true;this.isShowDescTask=false;this.isShowDescProject=false;this.isShowNewProject=true;this.isEditable=false;this.isShowConMenu=false;this.correctError=false;this.maxWidthPanelNames=400;this.minWorkLength=8;this.paramShowTask=[];this.paramShowProject=[];this.savePath=null;this.loadPath=null;this.divTimeInfo=null;this.divInfo=null;this.panelNames=null;this.panelTime=null;this.oData=null;this.content=null;this.panelErrors=null;this.contextMenu=null;this.hourInPixelsWork=this.dayInPixels/this.hoursInDay;this.hourInPixels=this.dayInPixels/24;this.countDays=0;this.startDate=null;this.initialPos=0;this.contentHeight=0;this.contentWidth=0;this._oDataHeight=0;this.Project=[];this.arrProjects=[];this.xmlLoader=null;this._isIE=false;this._isFF=false;this._isOpera=false;this._isMove=false;this._isResize=false;this._isError=false;this.imgs="codebase/imgs/";this.stylePath="codebase/dhtmlxgantt.css";this.shortMonthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];this._useShortMonthNames=true;dhtmlxEventable(this)}GanttChart.prototype.setImagePath=function(a){this.imgs=a};GanttChart.prototype.setStylePath=function(a){this.stylePath=a};GanttChart.prototype.setSavePath=function(a){this.savePath=a};GanttChart.prototype.setLoadPath=function(a){this.loadPath=a};GanttChart.prototype.setCorrectError=function(a){this.correctError=a};GanttChart.prototype.showDescTask=function(a,b){this.isShowDescTask=a;var c=new Array(5);if(this.isShowDescTask){if(b){var d=b.split(",");for(var i=0;i<d.length;i++){var k=this.getParamShowTask(d[i]);c[k]=1}}else{c[this.getParamShowTask('')]=1}this.paramShowTask=this.getValueShowTask(c)}};GanttChart.prototype.showDescProject=function(a,b){this.isShowDescProject=a;var c=new Array(4);if(this.isShowDescProject){if(b){var d=b.split(",");for(var i=0;i<d.length;i++){var k=this.getParamShowProject(d[i]);c[k]=1}}else{c[this.getParamShowProject('')]=1}this.paramShowProject=this.getValueShowProject(c)}};GanttChart.prototype.showContextMenu=function(a){this.isShowConMenu=a};GanttChart.prototype.setContextMenu=function(a){this.showContextMenu(true);this.contextMenu=a};GanttChart.prototype.showNewProject=function(a){this.isShowNewProject=a};GanttChart.prototype.getParamShowTask=function(a){switch(a){case'n':return 0;break;case'd':return 1;break;case'e':return 2;break;case'p':return 3;break;case's-f':return 4;break;default:return 0;break}};GanttChart.prototype.getParamShowProject=function(a){switch(a){case'n':return 0;break;case'd':return 1;break;case's':return 2;break;case'p':return 3;break;default:return 0;break}};GanttChart.prototype.getValueShowTask=function(a){var b=[];for(var i=0;i<a.length;i++){if(a[i]){switch(i){case 0:b.push('Name');break;case 1:b.push('Duration');break;case 2:b.push('EST');break;case 3:b.push('PercentComplete');break;case 4:b.push('S-F');break;default:break}}}return b};GanttChart.prototype.getValueShowProject=function(a){var b=[];for(var i=0;i<a.length;i++){if(a[i]){switch(i){case 0:b.push('Name');break;case 1:b.push('Duration');break;case 2:b.push('StartDate');break;case 3:b.push('PercentComplete');break;default:break}}}return b};GanttChart.prototype.setEditable=function(a){this.isEditable=a};GanttChart.prototype.showTreePanel=function(a){this._showTreePanel=a};GanttChart.prototype.showTooltip=function(a){this._showTooltip=a};GanttChart.prototype.getProjectById=function(a){for(var i=0;i<this.arrProjects.length;i++){if(this.arrProjects[i].Project.Id==a){return this.arrProjects[i]}}return null};GanttChart.prototype.getBrowserType=function(){if(navigator.appName.indexOf('Explorer')!=-1){this._isIE=true}else if(navigator.userAgent.indexOf('Mozilla')!=-1){this._isFF=true}else if(navigator.userAgent.indexOf('Opera')!=-1){this._isOpera=true}};GanttChart.prototype.addProject=function(a){this.Project.push(a)};GanttProject.prototype.deleteTask=function(a){var b=this.getTaskById(a);if(b){this.deleteChildTask(b)}else{this.Chart.Error.throwError("DATA_INSERT_ERROR",30,[a]);}};GanttChart.prototype.deleteProject=function(a){var b=this.getProjectById(a);if(b){if(b.arrTasks.length>0){while(b.arrTasks.length>0){b.deleteChildTask(b.arrTasks[0])}}if(b.nextProject)b.shiftNextProject(b,-23);for(var i=0;i<this.Project.length;i++){if(this.Project[i].Id==b.Project.Id){this.Project.splice(i,1)}}if((b.previousProject)&&(b.nextProject)){var c=b.previousProject;c.nextProject=b.nextProject}if((b.previousProject)&&!(b.nextProject)){var c=b.previousProject;c.nextProject=null}if(!(b.previousProject)&&(b.nextProject)){var e=b.nextProject;e.previousProject=null}for(var i=0;i<this.arrProjects.length;i++){if(this.arrProjects[i].Project.Id==a){this.arrProjects.splice(i,1)}}b.projectItem[0].parentNode.removeChild(b.projectItem[0]);if(this.isShowDescProject){b.descrProject.parentNode.removeChild(b.descrProject)}if(this._showTreePanel){b.projectNameItem.parentNode.removeChild(b.projectNameItem)}this._oDataHeight-=11+this.heightTaskItem;if(this.Project.length==0){if(this.isShowNewProject){var d=new Date(this.startDate);var t=new Date(d.setDate(d.getDate()+1));var f=new GanttProjectInfo(1,"New project",t);this.Project.push(f);var b=new GanttProject(this,f);b.create();this.arrProjects.push(b);this._oDataHeight+=11+this.heightTaskItem}}}else{this.Error.throwError("DATA_INSERT_ERROR",31,[a]);}};GanttProject.prototype.setName=function(a){if((a!="")&&(a!=null)){this.Project.Name=a;if(this.Chart._showTreePanel){this.projectNameItem.innerHTML=a;this.projectNameItem.title=a;this.checkWidthProjectNameItem()}if(this.Chart.isShowDescProject)this.descrProject.innerHTML=this.getDescStr();this.addDayInPanelTime()}};GanttProject.prototype.setPercentCompleted=function(a){a=parseInt(a);if(isNaN(a)){this.Chart.Error.throwError("DATA_INSERT_ERROR",6,null);return false}if(a>100){this.Chart.Error.throwError("DATA_INSERT_ERROR",7,null);return false}else if(a<0){this.Chart.Error.throwError("DATA_INSERT_ERROR",8,null);return false}if((a>0)&&(a<100)&&(this.percentCompleted>0)&&(this.percentCompleted<100)){this.projectItem[0].firstChild.rows[0].cells[0].width=parseInt(a)+"%";this.projectItem[0].firstChild.rows[0].cells[0].firstChild.style.width=(a*this.Duration*this.Chart.hourInPixelsWork)/100+"px";this.projectItem[0].firstChild.rows[0].cells[1].width=(100-parseInt(a))+"%";this.projectItem[0].firstChild.rows[0].cells[1].firstChild.style.width=((100-a)*this.Duration*this.Chart.hourInPixelsWork)/100+"px"}else if(((a==0)||(a==100))&&(this.percentCompleted>0)&&(this.percentCompleted<100)){if(a==0){this.projectItem[0].firstChild.rows[0].cells[0].parentNode.removeChild(this.projectItem[0].firstChild.rows[0].cells[0]);this.projectItem[0].firstChild.rows[0].cells[0].width=100+"%";this.projectItem[0].firstChild.rows[0].cells[0].firstChild.style.width=this.Duration*this.Chart.hourInPixelsWork+"px"}else if(a==100){this.projectItem[0].firstChild.rows[0].cells[1].parentNode.removeChild(this.projectItem[0].firstChild.rows[0].cells[1]);this.projectItem[0].firstChild.rows[0].cells[0].width=100+"%";this.projectItem[0].firstChild.rows[0].cells[0].firstChild.style.width=this.Duration*this.Chart.hourInPixelsWork+"px"}}else if(((a==0)||(a==100))&&((this.percentCompleted==0)||(this.percentCompleted==100))){if((a==0)&&(this.percentCompleted==100)){this.projectItem[0].firstChild.rows[0].cells[0].firstChild.src=this.Chart.imgs+"progress_bg.png"}else if((a==100)&&(this.percentCompleted==0)){this.projectItem[0].firstChild.rows[0].cells[0].firstChild.src=this.Chart.imgs+"parentnode_filled.png"}}else if(((a>0)||(a<100))&&((this.percentCompleted==0)||(this.percentCompleted==100))){this.projectItem[0].firstChild.rows[0].cells[0].parentNode.removeChild(this.projectItem[0].firstChild.rows[0].cells[0]);var b=document.createElement("TD");this.projectItem[0].firstChild.rows[0].appendChild(b);b.width=a+"%";var c=document.createElement("img");c.style.width=(a*this.Duration*this.Chart.hourInPixelsWork)/100+"px";c.style.height=this.Chart.heightTaskItem+"px";b.appendChild(c);c.src=this.Chart.imgs+"parentnode_filled.png";b=document.createElement("TD");this.projectItem[0].firstChild.rows[0].appendChild(b);b.width=(100-a)+"%";c=document.createElement("img");c.style.width=((100-a)*this.Duration*this.Chart.hourInPixelsWork)/100+"px";c.style.height=this.Chart.heightTaskItem+"px";b.appendChild(c);c.src=this.Chart.imgs+"progress_bg.png"}else if(this.percentCompleted==-1){if(a==100){this.projectItem[0].firstChild.rows[0].cells[0].firstChild.src=this.Chart.imgs+"parentnode_filled.png"}else if(a<100&&a>0){this.projectItem[0].firstChild.rows[0].cells[0].parentNode.removeChild(this.projectItem[0].firstChild.rows[0].cells[0]);var b=document.createElement("TD");this.projectItem[0].firstChild.rows[0].appendChild(b);b.width=a+"%";var c=document.createElement("img");c.style.width=(a*this.Duration*this.Chart.hourInPixelsWork)/100+"px";c.style.height=this.Chart.heightTaskItem+"px";b.appendChild(c);c.src=this.Chart.imgs+"parentnode_filled.png";b=document.createElement("TD");this.projectItem[0].firstChild.rows[0].appendChild(b);b.width=(100-a)+"%";c=document.createElement("img");c.style.width=((100-a)*this.Duration*this.Chart.hourInPixelsWork)/100+"px";c.style.height=this.Chart.heightTaskItem+"px";b.appendChild(c);c.src=this.Chart.imgs+"progress_bg.png"}}this.percentCompleted=a;if(this.Chart.isShowDescProject)this.descrProject.innerHTML=this.getDescStr();return true};GanttProject.prototype.deleteChildTask=function(a){if(a){if(a.cTaskItem[0].style.display=="none"){this.Chart.openTree(a.parentTask)}if(a.childPredTask.length>0){for(var i=0;i<a.childPredTask.length;i++){for(var t=0;t<a.childPredTask[i].cTaskItem[1].length;t++){a.childPredTask[i].cTaskItem[1][t].parentNode.removeChild(a.childPredTask[i].cTaskItem[1][t])}a.childPredTask[i].cTaskItem[1]=[];a.childPredTask[i].predTask=null}}if(a.childTask.length>0){while(a.childTask.length>0){this.deleteChildTask(a.childTask[0])}}if(a.cTaskItem[0].style.display!="none")a.shiftCurrentTasks(a,-23);this.Project.deleteTask(a.TaskInfo.Id);if(a.cTaskItem[0]){a.cTaskItem[0].parentNode.removeChild(a.cTaskItem[0])}if(this.Chart.isShowDescTask){a.descrTask.parentNode.removeChild(a.descrTask)}if(a.cTaskItem[1].length>0){for(var j=0;j<a.cTaskItem[1].length;j++){a.cTaskItem[1][j].parentNode.removeChild(a.cTaskItem[1][j])}}if(a.cTaskNameItem[0]){a.cTaskNameItem[0].parentNode.removeChild(a.cTaskNameItem[0])}if(a.cTaskNameItem[1]){for(var j=0;j<a.cTaskNameItem[1].length;j++){a.cTaskNameItem[1][j].parentNode.removeChild(a.cTaskNameItem[1][j])}}if(a.cTaskNameItem[2]){a.cTaskNameItem[2].parentNode.removeChild(a.cTaskNameItem[2])}if(a.parentTask){if(a.previousChildTask){if(a.nextChildTask){a.previousChildTask.nextChildTask=a.nextChildTask}else{a.previousChildTask.nextChildTask=null}}var b=a.parentTask;for(var i=0;i<b.childTask.length;i++){if(b.childTask[i].TaskInfo.Id==a.TaskInfo.Id){b.childTask[i]=null;b.childTask.splice(i,1);break}}if(b.childTask.length==0){if(b.cTaskNameItem[2]){b.cTaskNameItem[2].parentNode.removeChild(b.cTaskNameItem[2]);b.cTaskNameItem[2]=null}}}else{if(a.previousParentTask){if(a.nextParentTask){a.previousParentTask.nextParentTask=a.nextParentTask}else{a.previousParentTask.nextParentTask=null}}var c=a.Project;for(var i=0;i<c.arrTasks.length;i++){if(c.arrTasks[i].TaskInfo.Id==a.TaskInfo.Id){c.arrTasks.splice(i,1)}}}if(a.predTask){var d=a.predTask;for(var i=0;i<d.childPredTask.length;i++){if(d.childPredTask[i].TaskInfo.Id==a.TaskInfo.Id){d.childPredTask[i]=null;d.childPredTask.splice(i,1)}}}if(a.Project.arrTasks.length!=0){a.Project.shiftProjectItem()}else{a.Project.projectItem[0].style.display="none";if(this.Chart.isShowDescProject)this.hideDescrProject()}this.Chart._oDataHeight-=11+this.Chart.heightTaskItem}};GanttProject.prototype.insertTask=function(a,b,c,d,e,f,g){var h=null;var j=null;if(this.Project.getTaskById(a)){this.Chart.Error.throwError("DATA_INSERT_ERROR",22,[a]);return false}if((!d)||(d<this.Chart.minWorkLength)){d=this.Chart.minWorkLength}if((!b)||(b=="")){b=a}if((!e)||(e=="")){e=0}else{e=parseInt(e);if(e<0||e>100){this.Chart.Error.throwError("DATA_INSERT_ERROR",35,null);return false}}var k=false;if((g)&&(g!="")){var l=this.Project.getTaskById(g);if(!l){this.Chart.Error.throwError("DATA_INSERT_ERROR",21,[g]);return false}c=c||l.EST;if(c<l.EST){this.Chart.Error.throwError("DATA_INSERT_ERROR",20,[a,g]);return false}h=new GanttTaskInfo(a,b,c,d,e,f);if(!this.Chart.checkPosParentTask(l,h)){this.Chart.Error.throwError("DATA_INSERT_ERROR",19,[g,a]);return false}h.ParentTask=l;var m=this.getTaskById(l.Id);var n=false;if(m.cTaskItem[0].style.display=="none"){n=true}else if(m.cTaskNameItem[2]){if(!m._isOpen){n=true}}if(n){if(m.childTask.length==0){this.Chart.openTree(m.parentTask)}else{this.Chart.openTree(m)}}if(f!=""){var o=this.Project.getTaskById(f);if(!o){this.Chart.Error.throwError("DATA_INSERT_ERROR",27,[f]);return false}if(o.ParentTask){if(o.ParentTask.Id!=h.ParentTask.Id){this.Chart.Error.throwError("DATA_INSERT_ERROR",32,[o.Id,h.Id]);return false}}else{this.Chart.Error.throwError("DATA_INSERT_ERROR",32,[o.Id,h.Id]);return false}if(!this.Chart.checkPosPredecessorTask(o,h)){this.Chart.correctPosPredecessorTask(o,h)}h.PredecessorTask=o}var p=false;if(k)for(var i=0;i<l.ChildTasks.length;i++){if(h.EST<l.ChildTasks[i].EST){l.ChildTasks.splice(i,0,h);if(i>0){l.ChildTasks[i-1].nextChildTask=l.ChildTasks[i];l.ChildTasks[i].previousChildTask=l.ChildTasks[i-1]}if(l.ChildTasks[i+1]){l.ChildTasks[i+1].previousChildTask=l.ChildTasks[i];l.ChildTasks[i].nextChildTask=l.ChildTasks[i+1]}p=true;break}}if(!p){if(l.ChildTasks.length>0){l.ChildTasks[l.ChildTasks.length-1].nextChildTask=h;h.previousChildTask=l.ChildTasks[l.ChildTasks.length-1]}l.ChildTasks.push(h)}if(l.ChildTasks.length==1){m.cTaskNameItem[2]=m.createTreeImg()}j=new GanttTask(h,this,this.Chart);j.create();if(h.nextChildTask)j.nextChildTask=j.Project.getTaskById(h.nextChildTask.Id);j.addDayInPanelTime();j.shiftCurrentTasks(j,23)}else{c=c||this.Project.StartDate;h=new GanttTaskInfo(a,b,c,d,e,f);if(h.EST<=this.Chart.startDate){this.Chart.Error.throwError("DATA_INSERT_ERROR",18,[h.Id]);return false}if(f!=""){var o=this.Project.getTaskById(f);if(!o){this.Chart.Error.throwError("DATA_INSERT_ERROR",27,[f]);return false}if(!this.Chart.checkPosPredecessorTask(o,h)){this.Chart.correctPosPredecessorTask(o,h)}if(o.ParentTask){this.Chart.Error.throwError("DATA_INSERT_ERROR",15,[h.Id,o.Id]);return false}h.PredecessorTask=o}var p=false;if(k)for(var i=0;i<this.Project.ParentTasks.length;i++){if(c<this.Project.ParentTasks[i].EST){this.Project.ParentTasks.splice(i,0,h);if(i>0){this.Project.ParentTasks[i-1].nextParentTask=h;h.previousParentTask=this.Project.ParentTasks[i-1]}if(this.Project.ParentTasks[i+1]){this.Project.ParentTasks[i+1].previousParentTask=h;h.nextParentTask=this.Project.ParentTasks[i+1]}p=true;break}}if(!p){if(this.Project.ParentTasks.length>0){this.Project.ParentTasks[this.Project.ParentTasks.length-1].nextParentTask=h;h.previousParentTask=this.Project.ParentTasks[this.Project.ParentTasks.length-1]}this.Project.ParentTasks.push(h)}j=new GanttTask(h,this,this.Chart);j.create();if(h.nextParentTask)j.nextParentTask=j.Project.getTaskById(h.nextParentTask.Id);j.addDayInPanelTime();this.arrTasks.push(j);j.shiftCurrentTasks(j,23);this.projectItem[0].style.display="inline";this.setPercentCompleted(this.getPercentCompleted());this.shiftProjectItem();if(this.Chart.isShowDescProject){this.showDescrProject()}}this.Chart.checkHeighPanelTasks();return j};GanttChart.prototype.checkPosPredecessorTask=function(a,b){var c=this.getWidthOnDuration(a.Duration);var d=this.getPosOnDate(a.EST);var e=this.getPosOnDate(b.EST);return true};GanttChart.prototype.correctPosPredecessorTask=function(a,b,c){var d=new Date(a.EST);d.setHours(d.getHours()+(a.Duration/this.hoursInDay*24));if(d.getHours()>0){d.setHours(0);d.setDate(d.getDate()+1)}if(c)c.setEST(d,true);else b.EST=d;if(b.ParentTask){if(!this.checkPosParentTask(b.ParentTask,b)){var e=new Date(b.ParentTask.EST);e.setHours(e.getHours()+(b.ParentTask.Duration/this.hoursInDay*24));b.Duration=parseInt((parseInt((e-b.EST)/(1000*60*60)))*this.hoursInDay/24)}}};GanttChart.prototype.correctPosParentTask=function(a,b){if(!b.PredecessorTask){if(a.EST>b.EST){b.EST=new Date(a.EST)}if(!this.checkPosParentTask(a,b)){b.Duration=a.Duration}}else{this.correctPosPredecessorTask(b.PredecessorTask,b)}};GanttChart.prototype.checkPosParentTaskInTree=function(a){var b=false;for(var t=0;t<a.ChildTasks.length;t++){if(!this.checkPosParentTask(a,a.ChildTasks[t])){if(!this.correctError){this.Error.throwError("DATA_ERROR",28,[a.Id,a.ChildTasks[t].Id]);return true}else{this.correctPosParentTask(a,a.ChildTasks[t])}}if(a.EST>a.ChildTasks[t].EST){if(!this.correctError){this.Error.throwError("DATA_ERROR",33,[a.Id,a.ChildTasks[t].Id]);return true}else{this.correctPosParentTask(a,a.ChildTasks[t])}}if(a.ChildTasks[t].ChildTasks.length>0){b=this.checkPosParentTaskInTree(a.ChildTasks[t])}}return b};GanttChart.prototype.setPredTask=function(a){var b=false;for(var k=0;k<a.ParentTasks.length;k++){if(!this.isEmpty(a.ParentTasks[k].PredecessorTaskId)){a.ParentTasks[k].PredecessorTask=a.getTaskById(a.ParentTasks[k].PredecessorTaskId);if(!a.ParentTasks[k].PredecessorTask){if(!this.correctError){this.Error.throwError("DATA_ERROR",27,[a.ParentTasks[k].PredecessorTaskId]);return true}}a.ParentTasks[k].PredecessorTask.ChildPredTasks.push(a.ParentTasks[k])}if(a.ParentTasks[k].PredecessorTask){if(!this.checkPosPredecessorTask(a.ParentTasks[k].PredecessorTask,a.ParentTasks[k])){if(!this.correctError){this.Error.throwError("DATA_ERROR",26,[a.ParentTasks[k].PredecessorTask.Id,a.ParentTasks[k].Id]);return true}else{this.correctPosPredecessorTask(a.ParentTasks[k].PredecessorTask,a.ParentTasks[k])}}}b=this.setPredTaskInTree(a.ParentTasks[k]);if(b)return b}return b};GanttChart.prototype.setPredTaskInTree=function(a){var b=false;for(var t=0;t<a.ChildTasks.length;t++){if(!this.isEmpty(a.ChildTasks[t].PredecessorTaskId)){a.ChildTasks[t].PredecessorTask=a.Project.getTaskById(a.ChildTasks[t].PredecessorTaskId);if(!a.ChildTasks[t].PredecessorTask){if(!this.correctError){this.Error.throwError("DATA_ERROR",27,[a.ChildTasks[t].PredecessorTaskId]);return true}}if(!this.checkPosPredecessorTask(a.ChildTasks[t].PredecessorTask,a.ChildTasks[t])){if(!this.correctError){this.Error.throwError("DATA_ERROR",26,[a.ChildTasks[t].PredecessorTask.Id,a.ChildTasks[t].Id]);return true}else{this.correctPosPredecessorTask(a.ChildTasks[t].PredecessorTask,a.ChildTasks[t])}}a.ChildTasks[t].PredecessorTask.ChildPredTasks.push(a.ChildTasks[t])}if(a.ChildTasks[t].ChildTasks.length>0){b=this.setPredTaskInTree(a.ChildTasks[t])}}return b};GanttChart.prototype.checkPosParentTask=function(a,b){var c=this.getWidthOnDuration(a.Duration);var d=this.getPosOnDate(a.EST);var e=this.getPosOnDate(b.EST);var f=this.getWidthOnDuration(b.Duration);return(c+d)>=(e+f)};GanttChart.prototype.insertProject=function(a,b,c){if(this._isError){this.clearData();this.clearItems();this.hidePanelErrors();this._isError=false}if(this.startDate>=c){this.Error.throwError("DATA_INSERT_ERROR",14,null);return false}if(this.getProjectById(a)){this.Error.throwError("DATA_INSERT_ERROR",23,[a]);return false}this.checkHeighPanelTasks();var d=new GanttProjectInfo(a,b,c);this.Project.push(d);var e=new GanttProject(this,d);for(var i=0;i<this.arrProjects.length;i++){if(c<this.arrProjects[i].Project.StartDate){this.arrProjects.splice(i,0,e);if(i>0){e.previousProject=this.arrProjects[i-1];this.arrProjects[i-1].nextProject=e}if(i+1<=this.arrProjects.length){e.nextProject=this.arrProjects[i+1];this.arrProjects[i+1].previousProject=e;e.shiftNextProject(e,23)}e.create();if(this.isShowDescProject){e.hideDescrProject()}return e}}if(this.arrProjects.length>0){this.arrProjects[this.arrProjects.length-1].nextProject=e;e.previousProject=this.arrProjects[this.arrProjects.length-1]}this.arrProjects.push(e);e.create();if(this.isShowDescProject){e.hideDescrProject()}return e};GanttChart.prototype._showContextMenu=function(a,b){if(this.contextMenu.isDhtmlxMenuObject){var c=this.callEvent("onBeforeContextMenu",[this.contextMenu,b]);if(c===false)return;var x,y;if(_isIE){var d=window.document.documentElement,dEl1=window.document.body,corrector=new Array((d.scrollLeft||dEl1.scrollLeft),(d.scrollTop||dEl1.scrollTop));x=a.clientX+corrector[0];y=a.clientY+corrector[1]}else{x=a.pageX;y=a.pageY}this.contextMenu.showContextMenu(x-1,y-1)}else{var e=a.srcElement||a.target;this.contextMenu.showContextMenu(e.style.left,e.style.top,b)}};GanttChart.prototype.openTree=function(a){var b=this.getLastCloseParent(a);if(a.TaskInfo.Id!=b.TaskInfo.Id){this.openNode(b);this.openTree(a)}else{this.openNode(b)}};GanttChart.prototype.openNode=function(a){if(!a._isOpen){a.cTaskNameItem[2].src=this.imgs+"minus.gif";a._isOpen=true;a.shiftCurrentTasks(a,a._heightHideTasks);a.showChildTasks(a,a._isOpen);a._heightHideTasks=0}};GanttChart.prototype.getLastCloseParent=function(a){if(a.parentTask){if((!a.parentTask._isOpen)||(a.parentTask.cTaskNameItem[2].style.display=="none")){return this.getLastCloseParent(a.parentTask)}else{return a}}else{return a}};GanttTask.prototype.setPredecessor=function(a){if(a=="")this.clearPredTask();else{var b=this.TaskInfo;if(b.Id==a){this.Chart.Error.throwError("DATA_INSERT_ERROR",36);return false}var c=this.Project.getTaskById(a);if(!c){this.Chart.Error.throwError("DATA_INSERT_ERROR",27,[a]);return false}var d=c.TaskInfo;var e=d.ParentTask==null,a2=b.ParentTask==null;if(e&&!a2||!e&&a2||!e&&!a2&&(d.ParentTask.Id!=b.ParentTask.Id)){this.Chart.Error.throwError("DATA_INSERT_ERROR",32,[d.Id,b.Id]);return false}this.clearPredTask();if(!this.Chart.checkPosPredecessorTask(d,b)){this.Chart.correctPosPredecessorTask(d,b,this)}b.PredecessorTaskId=a;b.PredecessorTask=d;this.predTask=c;c.childPredTask.push(this);this.cTaskItem[1]=this.createConnectingLinesDS()}return true};GanttTask.prototype.clearPredTask=function(){if(this.predTask){var a=this.predTask.childPredTask;for(var i=0;i<a.length;i++){if(a[i]==this){a.splice(i,1);break}}for(var i=0;i<this.cTaskItem[1].length;i++){this.cTaskItem[1][i].parentNode.removeChild(this.cTaskItem[1][i])}this.cTaskItem[1]=[];this.TaskInfo.PredecessorTaskId=null;this.TaskInfo.PredecessorTask=null;this.predTask=null}};GanttTask.prototype.setEST=function(a,b){this.moveChild=b;this.getMoveInfo();var c=this.Chart.getPosOnDate(a);if((parseInt(this.cTaskItem[0].firstChild.firstChild.width)+c>this.maxPosXMove)&&(this.maxPosXMove!=-1)){this.Chart.Error.throwError("DATA_INSERT_ERROR",12,[this.TaskInfo.Id]);this.maxPosXMove=-1;this.minPosXMove=-1;return false}if(c<this.minPosXMove){this.Chart.Error.throwError("DATA_INSERT_ERROR",11,[this.TaskInfo.Id]);this.maxPosXMove=-1;this.minPosXMove=-1;return false}this.cTaskItem[0].style.left=c;var d=c-this.posX;this.moveCurrentTaskItem(d,b);this.Project.shiftProjectItem();if(this.Chart.isShowDescTask)this.descrTask.innerHTML=this.getDescStr();this.addDayInPanelTime();this.posX=0;this.maxPosXMove=-1;this.minPosXMove=-1;return true};GanttTask.prototype.setDuration=function(a){this.getResizeInfo();var b=this.Chart.getWidthOnDuration(a);if((b>this.maxWidthResize)&&(this.maxWidthResize!=-1)){this.Chart.Error.throwError("DATA_INSERT_ERROR",10,[this.TaskInfo.Id]);return false}else if(b<this.minWidthResize){this.Chart.Error.throwError("DATA_INSERT_ERROR",9,[this.TaskInfo.Id]);return false}else{this.taskItemWidth=parseInt(this.cTaskItem[0].firstChild.firstChild.width);this.resizeTaskItem(b);this.endResizeItem();if(this.Chart.isShowDescTask)this.descrTask.innerHTML=this.getDescStr();return true}};GanttTask.prototype.setPercentCompleted=function(a){a=parseInt(a);if(isNaN(a)){this.Chart.Error.throwError("DATA_INSERT_ERROR",6,null);return false}if(a>100){this.Chart.Error.throwError("DATA_INSERT_ERROR",7,null);return false}if(a<0){this.Chart.Error.throwError("DATA_INSERT_ERROR",8,null);return false}if((a!=0)&&(a!=100)){if((this.TaskInfo.PercentCompleted!=0)&&(this.TaskInfo.PercentCompleted!=100)){this.cTaskItem[0].childNodes[0].firstChild.rows[0].cells[0].width=a+"%";this.cTaskItem[0].childNodes[0].firstChild.rows[0].cells[1].width=100-a+"%"}else if((this.TaskInfo.PercentCompleted==0)||(this.TaskInfo.PercentCompleted==100)){this.cTaskItem[0].childNodes[0].firstChild.rows[0].cells[0].parentNode.removeChild(this.cTaskItem[0].childNodes[0].firstChild.rows[0].cells[0]);var b=document.createElement("td");this.cTaskItem[0].childNodes[0].firstChild.rows[0].appendChild(b);b.height=this.Chart.heightTaskItem+"px";b.width=a+"%";var c=document.createElement("img");c.style.width=(a*this.TaskInfo.Duration*this.Chart.hourInPixelsWork)/100+"px";c.style.height=this.Chart.heightTaskItem+"px";b.appendChild(c);c.src=this.Chart.imgs+"progress_filled.png";b=document.createElement("td");this.cTaskItem[0].childNodes[0].firstChild.rows[0].appendChild(b);b.height=this.Chart.heightTaskItem+"px";b.width=(100-a)+"%";c=document.createElement("img");c.style.width=((100-a)*this.TaskInfo.Duration*this.Chart.hourInPixelsWork)/100+"px";c.style.height=this.Chart.heightTaskItem+"px";b.appendChild(c);c.src=this.Chart.imgs+"progress_bg.png"}}else if(a==0){if((this.TaskInfo.PercentCompleted!=0)&&(this.TaskInfo.PercentCompleted!=100)){this.cTaskItem[0].childNodes[0].firstChild.rows[0].cells[0].parentNode.removeChild(this.cTaskItem[0].childNodes[0].firstChild.rows[0].cells[0]);this.cTaskItem[0].childNodes[0].firstChild.rows[0].cells[0].width=100+"%"}else{this.cTaskItem[0].childNodes[0].firstChild.rows[0].cells[0].firstChild.src=this.Chart.imgs+"progress_bg.png"}}else if(a==100){if((this.TaskInfo.PercentCompleted!=0)&&(this.TaskInfo.PercentCompleted!=100)){this.cTaskItem[0].childNodes[0].firstChild.rows[0].cells[1].parentNode.removeChild(this.cTaskItem[0].childNodes[0].firstChild.rows[0].cells[1]);this.cTaskItem[0].childNodes[0].firstChild.rows[0].cells[0].width=100+"%"}else{this.cTaskItem[0].childNodes[0].firstChild.rows[0].cells[0].firstChild.src=this.Chart.imgs+"progress_filled.png"}}this.TaskInfo.PercentCompleted=a;this.taskItemWidth=parseInt(this.cTaskItem[0].firstChild.firstChild.width);this.resizeTaskItem(this.taskItemWidth);this.endResizeItem();if(this.Chart.isShowDescTask)this.descrTask.innerHTML=this.getDescStr();return true};GanttTask.prototype.setName=function(a){if((a!="")&&(a!=null)){this.TaskInfo.Name=a;if(this.Chart._showTreePanel){this.cTaskNameItem[0].innerHTML=a;this.cTaskNameItem[0].title=a;this.checkWidthTaskNameItem()}if(this.Chart.isShowDescTask)this.descrTask.innerHTML=this.getDescStr();this.addDayInPanelTime()}};GanttChart.prototype.getProjectInfoById=function(a){for(var i=0;i<this.Project.length;i++){if(this.Project[i].Id==a){return this.Project[i]}}return null};GanttChart.prototype.loadData=function(a,b,c){this.clearData();if((b==null)||(b=='undefined')){b=false}if((c==null)||(c=='undefined')){c=false}this.loadXML(a,b,c);this.Project.sort(this.sort_byStartDate);this.startDate=this.getStartDate();this.clearItems();for(var i=0;i<this.Project.length;i++){for(var k=0;k<this.Project[i].ParentTasks.length;k++){if((this.Project[i].ParentTasks[k].EST!=null)&&(this.Project[i].ParentTasks[k].EST!='')){this.setESTChild(this.Project[i].ParentTasks[k])}else{this.Error.throwError("DATA_ERROR",25,[this.Project[i].ParentTasks[k].Id]);return}if(this.setPredTask(this.Project[i]))return}for(var k=0;k<this.Project[i].ParentTasks.length;k++){if(this.Project[i].ParentTasks[k].EST<this.Project[i].StartDate){this.Error.throwError("DATA_ERROR",24,[this.Project[i].ParentTasks[k].Id,this.Project[i].Id]);return}if(this.checkPosParentTaskInTree(this.Project[i].ParentTasks[k]))return}this.sortTasksByEST(this.Project[i])}for(var i=0;i<this.Project.length;i++){var d=new GanttProject(this,this.Project[i]);if(this.arrProjects.length>0){var e=this.arrProjects[this.arrProjects.length-1];d.previousProject=e;e.nextProject=d}d.create();this.checkHeighPanelTasks();this.arrProjects.push(d);this.createTasks(d)}};GanttChart.prototype.clearAll=function(){this._oDataHeight=0;this.startDate=null;this._isError=false;this.hidePanelErrors();this.clearData();this.clearItems()};GanttChart.prototype.clearData=function(){this._oDataHeight=0;this.startDate=null;this._isError=false;this.hidePanelErrors();this.Project=[];this.arrProjects=[]};GanttChart.prototype.clearItems=function(){this.oData.removeChild(this.oData.firstChild);this.oData.appendChild(this.createPanelTasks());this.oData.firstChild.appendChild(this.divInfo);this.oData.firstChild.appendChild(this.panelErrors);if(this._showTreePanel){this.panelNames.removeChild(this.panelNames.firstChild);this.panelNames.appendChild(this.createPanelNamesTasks())}this.panelTime.removeChild(this.panelTime.firstChild);this.panelTime.appendChild(this.createPanelTime())};GanttChart.prototype.loadXML=function(a,b,c){if(b&&(a==null||a=="")){this.Error.throwError("DATA_SEND_ERROR",4,null);return}this.xmlLoader=new dtmlXMLLoaderObject(null,this,false);try{if(!b)try{this.xmlLoader.loadXMLString(a)}catch(e){this.Error.throwError("DATA_LOAD_ERROR",37,[a]);}else if(!c){this.xmlLoader.loadXML(this.loadPath+"?path="+a+"&rnd="+(new Date()-0),false)}else{this.xmlLoader.loadXML(a+"?rnd="+(new Date()-0),false)}this.doLoadDetails(c)}catch(e){this.Error.throwError("DATA_LOAD_ERROR",5,[a]);}};GanttChart.prototype.doLoadDetails=function(a){switch(this.xmlLoader.xmlDoc.status){case 0:if(!a){this.Error.throwError("DATA_LOAD_ERROR",1,null);return}break;case 404:if(!a){this.Error.throwError("DATA_LOAD_ERROR",5,[this.loadPath]);}else{this.Error.throwError("DATA_LOAD_ERROR",5,[this.xmlLoader.filePath])}return;break;case 500:this.Error.throwError("DATA_LOAD_ERROR",2,null);return;break;default:break}var b=null;var c=null;var d=null;var e=null;var f=null;var g=null;var h=this.xmlLoader.doXPath("//project");for(var j=0;j<h.length;j++){var k=h[j].getAttribute("startdate");var l=k.split(",");var m=new GanttProjectInfo(h[j].getAttribute("id"),h[j].getAttribute("name"),new Date(l[0],(parseInt(l[1])-1),l[2]));var n=this.xmlLoader.doXPath("./task",h[j]);for(var i=0;i<n.length;i++){c=n[i].getAttribute("id");b=(this.xmlLoader.doXPath("./name",n[i])[0].firstChild==null)?"":this.xmlLoader.doXPath("./name",n[i])[0].firstChild.nodeValue;var o=(this.xmlLoader.doXPath("./est",n[i])[0].firstChild==null)?"":this.xmlLoader.doXPath("./est",n[i])[0].firstChild.nodeValue;d=o.split(",");e=(this.xmlLoader.doXPath("./duration",n[i])[0].firstChild==null)?"":this.xmlLoader.doXPath("./duration",n[i])[0].firstChild.nodeValue;f=(this.xmlLoader.doXPath("./percentcompleted",n[i])[0].firstChild==null)?"":this.xmlLoader.doXPath("./percentcompleted",n[i])[0].firstChild.nodeValue;g=(this.xmlLoader.doXPath("./predecessortasks",n[i])[0].firstChild==null)?"":this.xmlLoader.doXPath("./predecessortasks",n[i])[0].firstChild.nodeValue;var p=new GanttTaskInfo(c,b,new Date(d[0],(parseInt(d[1])-1),d[2]),e,f,g);var q=this.xmlLoader.doXPath("./childtasks",n[i]);var r=this.xmlLoader.doXPath("./task",q[0]);if(r.length!=0)this.readChildTasksXML(p,r);m.addTask(p)}this.addProject(m)}};GanttChart.prototype.readChildTasksXML=function(a,b){var c=null;var d=null;var e=null;var f=null;var g=null;var h=null;for(var i=0;i<b.length;i++){d=b[i].getAttribute("id");c=(this.xmlLoader.doXPath("./name",b[i])[0].firstChild==null)?"":this.xmlLoader.doXPath("./name",b[i])[0].firstChild.nodeValue;var j=(this.xmlLoader.doXPath("./est",b[i])[0].firstChild==null)?"":this.xmlLoader.doXPath("./est",b[i])[0].firstChild.nodeValue;e=j.split(",");f=(this.xmlLoader.doXPath("./duration",b[i])[0].firstChild==null)?"":this.xmlLoader.doXPath("./duration",b[i])[0].firstChild.nodeValue;g=(this.xmlLoader.doXPath("./percentcompleted",b[i])[0].firstChild==null)?"":this.xmlLoader.doXPath("./percentcompleted",b[i])[0].firstChild.nodeValue;h=(this.xmlLoader.doXPath("./predecessortasks",b[i])[0].firstChild==null)?"":this.xmlLoader.doXPath("./predecessortasks",b[i])[0].firstChild.nodeValue;var k=new GanttTaskInfo(d,c,new Date(e[0],(parseInt(e[1])-1),e[2]),f,g,h);k.ParentTask=a;a.addChildTask(k);var l=this.xmlLoader.doXPath("./childtasks",b[i]);var m=this.xmlLoader.doXPath("./task",l[0]);if(m.length!=0){this.readChildTasksXML(k,m)}}};GanttChart.prototype.getXML=function(){var a="<projects>";for(var i=0;i<this.Project.length;i++){a+="<project id ='"+this.Project[i].Id+"' name= '"+this.Project[i].Name+"' startdate = '"+this.Project[i].StartDate.getFullYear()+","+(this.Project[i].StartDate.getMonth()+1)+","+this.Project[i].StartDate.getDate()+"'>";for(var j=0;j<this.Project[i].ParentTasks.length;j++){a+="<task id ='"+this.Project[i].ParentTasks[j].Id+"'>";a+="<name>"+this.Project[i].ParentTasks[j].Name+"</name>";a+="<est>"+(this.Project[i].ParentTasks[j].EST.getMonth()+1)+","+this.Project[i].ParentTasks[j].EST.getFullYear()+","+this.Project[i].ParentTasks[j].EST.getDate()+"</est>";a+="<duration>"+this.Project[i].ParentTasks[j].Duration+"</duration>";a+="<percentcompleted>"+this.Project[i].ParentTasks[j].PercentCompleted+"</percentcompleted>";a+="<predecessortasks>"+this.Project[i].ParentTasks[j].PredecessorTaskId+"</predecessortasks>";a+="<childtasks>";a+=this.createChildTasksXML(this.Project[i].ParentTasks[j].ChildTasks);a+="</childtasks>";a+="</task>"}a+="</project>"}a+="</projects>";return a};GanttChart.prototype.createChildTasksXML=function(a){var b="";for(var n=0;n<a.length;n++){b+="<task id='"+a[n].Id+"'>";b+="<name>"+a[n].Name+"</name>";b+="<est>"+a[n].EST.getFullYear()+","+(a[n].EST.getMonth()+1)+","+a[n].EST.getDate()+"</est>";b+="<duration>"+a[n].Duration+"</duration>";b+="<percentcompleted>"+a[n].PercentCompleted+"</percentcompleted>";b+="<predecessortasks>"+a[n].PredecessorTaskId+"</predecessortasks>";if(a[n].ChildTasks){b+="<childtasks>";b+=this.createChildTasksXML(a[n].ChildTasks);b+="</childtasks>"}b+="</task>"}return b};GanttChart.prototype.sort_byEST=function(a,b){if(a.EST<b.EST)return-1;if(a.EST>b.EST)return 1;return 0};GanttChart.prototype.sort_byStartDate=function(a,b){if(a["StartDate"]<b["StartDate"])return-1;if(a["StartDate"]>b["StartDate"])return 1;return 0};GanttChart.prototype.setESTChild=function(a){for(var t=0;t<a.ChildTasks.length;t++){if((a.ChildTasks[t].EST==null)||(a.ChildTasks[t].EST=="")){a.ChildTasks[t].EST=a.EST}if(a.ChildTasks[t].ChildTasks.length!=0)this.setESTChild(a.ChildTasks[t])}};GanttChart.prototype.createPanelTasks=function(){var a=document.createElement("div");a.className="taskPanel";a.style.cssText="position:relative;";a.style.height=this.contentHeight-63+"px";var w=this.startDate?(this.startDate.getDay()-1):((new Date(0)).getDay()-1);if(w==-1)w=6;a.style.background="url("+this.imgs+"bg_week.png) -"+(w*24)+"px 0px";this.panelTasks=a;return a};GanttChart.prototype.createPanelNamesTasks=function(){var a=document.createElement("div");a.innerHTML="&nbsp;";a.style.cssText="position:relative;background:url("+this.imgs+"bg.png)";a.style.height=this.contentHeight-63+"px";a.style.width=this.maxWidthPanelNames+"px";return a};GanttChart.prototype.createPopUpInfo=function(){var a=document.createElement("div");a.style.cssText='display: none;';var b=document.createElement("table");b.style.cssText="position:absolute;top:0px;left:0px";b.className="poPupInfo";a.appendChild(b);var c=b.insertRow(b.rows.length);var d=document.createElement("td");c.appendChild(d);this.divInfo=a;return a};GanttChart.prototype.createPopUpTimeInfo=function(){var a=document.createElement("div");a.style.display="none";var b=document.createElement("table");b.className="poPupTime";a.appendChild(b);var c=b.insertRow(b.rows.length);var d=document.createElement("td");d.align="center";c.appendChild(d);return a};GanttChart.prototype.createPanelTime=function(){var a=document.createElement("div");a.style.position="relative";var b=document.createElement("table");a.appendChild(b);b.cellPadding="0px";b.border="0px";b.cellSpacing="0px";b.bgColor="#FFFFFF";b.style.marginTop="0px";var c=b.insertRow(b.rows.length);var d=b.insertRow(b.rows.length);for(var i=0;i<this.countDays;i++){this.addPointInTimePanel(d,a);this.addDayInPanelTime(d)}return a};GanttChart.prototype.addPointInTimePanel=function(a,b){var c=document.createElement("div");c.style.cssText="position:absolute;left:"+(a.cells.length*this.dayInPixels)+"px;top:20px;height:20px;width:1px;font-size:1px;margin-left:0px;margin-right:0px;margin-top:0px;margin-bottom:0px;background:#f1f3f1;";b.appendChild(c)};GanttChart.prototype._calculateMonthColSpan=function(a,b){var c=a.getMonth();for(var i=1;i<=b;i++){a.setDate(a.getDate()+1);var d=a.getMonth();if(d!=c)return i}return b};GanttChart.prototype.getMonthScaleLabel=function(a){return(this._useShortMonthNames?this.shortMonthNames:this.monthNames)[a.getMonth()]+" '"+(""+a.getFullYear()).substring(2)};GanttChart.prototype.useShortMonthNames=function(a){this._useShortMonthNames=a};GanttChart.prototype.setShortMonthNames=function(a){this.shortMonthNames=a};GanttChart.prototype.setMonthNames=function(a){this.monthNames=a};GanttChart.prototype.addDayInPanelTime=function(a){var b=this,idx=a.cells.length,date=new Date(this.startDate);var c=a.insertCell(idx);c.style.height="20px";c.style.width=this.dayInPixels+"px";c.className="dayNumber";date.setDate(date.getDate()+parseInt(idx));var d=date.getDate();c.innerHTML=d;c.setAttribute("idx",idx);var e=a.parentNode.parentNode.rows[0];if(idx==0||d==1){var f=e.insertCell(e.cells.length);f.className="monthName";f.style.height="20px";if(e.cells.length%2==0)f.style.backgroundColor="#f7f8f7";f.colSpan=this._calculateMonthColSpan(new Date(date),Math.max(1,this.countDays-idx));f.innerHTML=this.getMonthScaleLabel(date)}else{var n=e.cells.length,cs=0;for(var i=0;i<n;i++){cs+=e.cells[i].colSpan}if(idx>=cs)e.cells[n-1].colSpan+=1}var w=date.getDay();if(w==0||w==6)c.style.backgroundColor="#f7f8f7"};GanttChart.prototype.incHeightPanelTasks=function(a){var b=this.oData.firstChild;b.style.height=parseInt(b.style.height)+a+"px"};GanttChart.prototype.incHeightPanelNames=function(a){var b=this.panelNames.firstChild;b.style.height=parseInt(b.style.height)+a+"px"};GanttChart.prototype.checkHeighPanelTasks=function(){this._oDataHeight+=11+this.heightTaskItem;if((parseInt(this.oData.firstChild.style.height)<=this._oDataHeight)){this.incHeightPanelTasks(this.heightTaskItem+11);if(this._showTreePanel)this.incHeightPanelNames(this.heightTaskItem+11)}};GanttChart.prototype.sortTasksByEST=function(a){a.ParentTasks.sort(this.sort_byEST);for(var i=0;i<a.ParentTasks.length;i++){a.ParentTasks[i]=this.sortChildTasks(a.ParentTasks[i])}};GanttChart.prototype.sortChildTasks=function(a){a.ChildTasks.sort(this.sort_byEST);for(var i=0;i<a.ChildTasks.length;i++){if(a.ChildTasks[i].ChildTasks.length>0)this.sortChildTasks(a.ChildTasks[i])}return a};GanttChart.prototype.errorDataHandler=function(a,b,c){if(!this._isError){this.clearData();this.showPanelErrors();this._isError=true}this.addErrorInPanelErrors(a,b)};GanttChart.prototype.createPanelErrors=function(){var a=document.createElement("table");a.width="100%";a.style.display="none";a.className="panelErrors";this.panelErrors=a;return a};GanttChart.prototype.showPanelErrors=function(){this.panelErrors.style.display="inline"};GanttChart.prototype.hidePanelErrors=function(){for(var i=0;i<this.panelErrors.rows.length;i++){this.panelErrors.rows[i].parentNode.removeChild(this.panelErrors.rows[i])}this.panelErrors.style.display="none"};GanttChart.prototype.addErrorInPanelErrors=function(a,b){var c=this.panelErrors.insertRow(this.panelErrors.rows.length);var d=document.createElement("td");d.style.height="20px";d.style.width="100px";d.innerHTML=a;c.appendChild(d);d=document.createElement("td");c.appendChild(d);d.innerHTML=b};GanttChart.prototype.errorSendDataHandler=function(a,b,c){alert(b)};GanttChart.prototype.errorLoadDataHandler=function(a,b,c){alert(b)};GanttChart.prototype.errorAPIHandler=function(a,b,c){alert(b)};GanttChart.prototype.saveData=function(a){try{if(!this.dhtmlXMLSenderObject.isProcessed){this.dhtmlXMLSenderObject.sendData(a,this.savePath,this.getXML())}}catch(e){this.Error.throwError("DATA_SEND_ERROR",e,null);}};GanttChart.prototype.create=function(d){var f=this;var g=document.getElementById(d);this.content=g;this.getBrowserType();if(this._isIE){document.body.attachEvent('onselectstart',function(){window.event.returnValue=false});document.body.attachEvent('onkeydown',function(){if(event.keyCode==65&&event.ctrlKey)window.event.returnValue=false})}else{g.addEventListener('mousedown',function(e){e.preventDefault()},true);document.addEventListener('keydown',function(e){if(e.keyCode==65&&e.ctrlKey)e.preventDefault()},true)}this.Error.catchError("DATA_ERROR",function(a,b,c){f.errorDataHandler(a,b,c)});this.Error.catchError("DATA_SEND_ERROR",function(a,b,c){f.errorSendDataHandler(a,b,c)});this.Error.catchError("DATA_INSERT_ERROR",function(a,b,c){f.errorAPIHandler(a,b,c)});this.Error.catchError("DATA_LOAD_ERROR",function(a,b,c){f.errorLoadDataHandler(a,b,c)});var h=document.createElement("table");h.cellPadding="0";h.cellSpacing="0";h.style.cssText="width: 100%; position: relative;";var j=h.insertRow(h.rows.length);var l;this.contentHeight=g.offsetHeight;this.contentWidth=g.offsetWidth;g.appendChild(h);this.countDays=this.getCountDays();this.Project.sort(this.sort_byStartDate);this.startDate=this.getStartDate();this.panelTime=document.createElement("div");this.panelTime.appendChild(this.createPanelTime());this.panelTime.style.cssText="position:relative;overflow:hidden;height:40px;top:0px;left:1px";this.oData=document.createElement("div");this.oData.appendChild(this.createPanelTasks());this.oData.style.cssText="position:relative;overflow:scroll;height:"+(this.contentHeight-40)+"px;border-left:#f1f3f1 1px solid";this.oData.firstChild.appendChild(this.createPanelErrors());if(this._showTreePanel){this.panelNames=document.createElement("div");l=document.createElement("td");l.vAlign="top";this.panelNames.appendChild(this.createPanelNamesTasks());this.panelNames.style.cssText="position:relative;top:40px;overflow:hidden;border-left:#f1f3f1 1px solid;border-bottom:#f1f3f1 1px solid";l.appendChild(this.panelNames);j.appendChild(l)}l=document.createElement("td");var m=document.createElement("div");m.style.cssText="position: relative;";m.appendChild(this.panelTime);m.appendChild(this.oData);l.appendChild(m);j.appendChild(l);if(this._showTreePanel){this.panelNames.style.height=(this.contentHeight-56)+"px";this.panelNames.style.width=this.maxWidthPanelNames+"px";this.oData.style.width=(this.contentWidth-this.maxWidthPanelNames)+"px";this.panelTasks.style.width=this.dayInPixels*this.countDays+"px";this.panelTime.style.width=(this.contentWidth-this.maxWidthPanelNames-0*18)+"px";this.panelTime.firstChild.style.width=this.dayInPixels*this.countDays+"px";if(this.isShowConMenu&&this.contextMenu==null)this.contextMenu=new contextMenu(this)}else{this.oData.style.width=this.contentWidth+"px";this.panelTime.style.width=(this.contentWidth-16)+"px"}if(this._isOpera){this.oData.onmousewheel=function(){return false}}this.oData.onscroll=function(){f.panelTime.scrollLeft=this.scrollLeft;if(f.panelNames){f.panelNames.scrollTop=this.scrollTop;if(f.isShowConMenu)f.contextMenu.hideContextMenu()}};this.divTimeInfo=this.createPopUpTimeInfo();m.appendChild(this.divTimeInfo);this.oData.firstChild.appendChild(this.createPopUpInfo());for(var i=0;i<this.Project.length;i++){for(var k=0;k<this.Project[i].ParentTasks.length;k++){if(this.isEmpty(this.Project[i].ParentTasks[k].EST)){this.Project[i].ParentTasks[k].EST=this.Project[i].StartDate}this.setESTChild(this.Project[i].ParentTasks[k]);if(this.setPredTask(this.Project[i]))return}for(var k=0;k<this.Project[i].ParentTasks.length;k++){if(this.Project[i].ParentTasks[k].EST<this.Project[i].StartDate){if(!this.correctError){this.Error.throwError("DATA_ERROR",24,[this.Project[i].ParentTasks[k].Id,this.Project[i].Id]);return}else{this.Project[i].ParentTasks[k].EST=this.Project[i].StartDate}}if(this.checkPosParentTaskInTree(this.Project[i].ParentTasks[k]))return}this.sortTasksByEST(this.Project[i])}for(var i=0;i<this.Project.length;i++){var n=new GanttProject(this,this.Project[i]);if(this.arrProjects.length>0){var o=this.arrProjects[this.arrProjects.length-1];n.previousProject=o;o.nextProject=n}n.create();this.checkHeighPanelTasks();this.arrProjects.push(n);this.createTasks(n)}return this};GanttChart.prototype.isEmpty=function(a){return(a==null||a=='')};GanttChart.prototype.getPrintableHTML=function(){var w=parseInt(this.oData.firstChild.style.width)-parseInt(this.oData.style.width);var h=parseInt(this.panelTasks.style.height)-parseInt(this.panelTasks.parentNode.style.height);this.oData.setAttribute("id","ganttPrint02");this.panelNames.setAttribute("id","ganttPrint03");var a='<html><head><link type="text/css" rel="stylesheet" href="'+this.stylePath+'"><scr'+'ipt>onload=function(){var w='+w+',h='+h+',c1=document.getElementById("ganttPrint01"),c2=document.getElementById("ganttPrint02"),c3=document.getElementById("ganttPrint03");'+'c2.style.width=parseInt(c2.style.width)+w+300+"px";c2.previousSibling.style.width=c2.style.width;c1.style.width=parseInt(c1.style.width)+w+"px";c2.style.height=parseInt(c2.style.height)+h+"px";'+'c2.style.overflow="hidden";c3.style.height=c3.firstChild.style.height;c1.style.height=parseInt(c1.style.height)+h+"px";}</scr'+'ipt></head>'+'<body><div id="ganttPrint01" style="'+this.content.style.cssText+'">'+this.content.innerHTML+'</div></body></html>';this.oData.setAttribute("id",null);this.panelNames.setAttribute("id",null);return a};GanttChart.prototype.printToWindow=function(a){var o=window.open();o.document.write(this.getPrintableHTML());o.document.close();if(a!==null){o.alert(a?a:"Use browser's menu \"File->Print preview\" to setup page layout.")}};GanttChart.prototype.getStartDate=function(){for(var i=0;i<this.Project.length;i++){if(this.startDate){if(this.Project[i].StartDate<this.startDate){this.startDate=new Date(this.Project[i].StartDate)}}else{this.startDate=new Date(this.Project[i].StartDate)}}this.initialPos=24*this.hourInPixels;if(this.startDate){return new Date(this.startDate.setHours(this.startDate.getHours()-24))}else{return new Date()}};GanttChart.prototype.getCountDays=function(){if(this._showTreePanel){return parseInt((this.contentWidth-this.maxWidthPanelNames)/(this.hourInPixels*24))}else{return parseInt((this.contentWidth)/(this.hourInPixels*24))}};GanttChart.prototype.createTasks=function(a){for(var j=0;j<a.Project.ParentTasks.length;j++){if(j>0){a.Project.ParentTasks[j-1].nextParentTask=a.Project.ParentTasks[j];a.Project.ParentTasks[j].previousParentTask=a.Project.ParentTasks[j-1]}var b=new GanttTask(a.Project.ParentTasks[j],a,this);a.arrTasks.push(b);b.create();this.checkHeighPanelTasks();if(a.Project.ParentTasks[j].ChildTasks.length>0){this.createChildItemControls(a.Project.ParentTasks[j].ChildTasks,a)}}};GanttChart.prototype.createChildItemControls=function(a,b){for(var i=0;i<a.length;i++){if(i>0){a[i].previousChildTask=a[i-1];a[i-1].nextChildTask=a[i]}var c=new GanttTask(a[i],b,this);c.create();this.checkHeighPanelTasks();if(a[i].ChildTasks.length>0){this.createChildItemControls(a[i].ChildTasks,b)}}};GanttTask.prototype.getPopUpInfo=function(a,b){var c=a.offsetTop+this.Chart.heightTaskItem+6;var d=a.offsetLeft+((b.layerX==null)?b.offsetX:b.layerX);var e=this.Chart.divInfo.lastChild;e.rows[0].cells[0].innerHTML="<div style='font-family: Arial, Helvetica, Sans-serif; font-size: 12px; font-weight: bold; color: #688060; margin: 0 0 4px 0;'>"+this.TaskInfo.Name+"</div>";e.rows[0].cells[0].innerHTML+="<span class='st'>Start Date:&nbsp;</span><span class='ut'>"+(this.TaskInfo.EST.getMonth()+1)+"."+this.TaskInfo.EST.getDate()+"."+this.TaskInfo.EST.getFullYear()+"</span><br/>";e.rows[0].cells[0].innerHTML+="<span class='st'>Duration:&nbsp;</span><span class='ut'>"+(this.TaskInfo.Duration/24.0).toFixed(1)+" days </span><br/>";e.rows[0].cells[0].innerHTML+="<span class='st'>Percent Complete:&nbsp;</span><span class='ut'>"+this.TaskInfo.PercentCompleted+"% </span><br/>";if(this.predTask){e.rows[0].cells[0].innerHTML+="<span class='st'>Predecessor Task:&nbsp;</span>";e.rows[0].cells[0].innerHTML+="<span class='lt'>"+this.TaskInfo.PredecessorTask.Name+"</span>"}if(this.TaskInfo.ChildTasks.length!=0){e.rows[0].cells[0].innerHTML+="<span class='st'>Child Tasks:&nbsp;</span>";for(var i=0;i<this.TaskInfo.ChildTasks.length;i++){e.rows[0].cells[0].innerHTML+=(i==this.TaskInfo.ChildTasks.length-1)?("<span class='lt'>*"+this.TaskInfo.ChildTasks[i].Name+"</span>"):("<span class='lt'>*"+this.TaskInfo.ChildTasks[i].Name+"</span>")}}if(this.TaskInfo.ParentTask){e.rows[0].cells[0].innerHTML+="<span class='st'>Parent Task:&nbsp;</span>";e.rows[0].cells[0].innerHTML+="<span class='lt'>*"+this.TaskInfo.ParentTask.Name+"</span>"}this.Chart.divInfo.style.cssText="z-index:2;position: absolute;display: inline;";if(c+this.Chart.divInfo.lastChild.offsetHeight+10>this.Chart.oData.offsetHeight+this.Chart.oData.scrollTop){this.Chart.divInfo.style.top=(c-this.Chart.divInfo.lastChild.offsetHeight-10-this.Chart.heightTaskItem)+"px"}else{this.Chart.divInfo.style.top=c+"px"}if(this.Chart.divInfo.lastChild.offsetWidth+d+10>this.Chart.oData.offsetWidth+this.Chart.oData.scrollLeft){this.Chart.divInfo.style.left=d-(this.Chart.divInfo.lastChild.offsetWidth+d+20-(this.Chart.oData.offsetWidth+this.Chart.oData.scrollLeft))+"px"}else{this.Chart.divInfo.style.left=d+"px"}};GanttTask.prototype.closePopUpInfo=function(){this.Chart.divInfo.style.display="none"};GanttTask.prototype.createConnectingLinesPN=function(){var a=[];return a};GanttTask.prototype.createConnectingLinesDS=function(){var a=this.Chart.oData.firstChild;var b=[];var c=new Image();c.src=this.Chart.imgs+"arr.gif";var d=document.createElement("div");var e=document.createElement("div");var f=parseInt(this.predTask.cTaskItem[0].style.left);var g=parseInt(this.predTask.cTaskItem[0].style.top);var h=parseInt(this.cTaskItem[0].style.left);var i=this.posY+2;var j=parseInt(this.predTask.cTaskItem[0].firstChild.firstChild.width);var k=parseInt(this.predTask.cTaskItem[0].firstChild.firstChild.width);if(g<i){d.style.cssText="border-width: 0px 0px 0px 1px; border-style: solid; border-color: #4A8F43;margin: 0px; padding: 0px;z-index:0;font-size: 1px;position: absolute;"+"height:"+(i-this.Chart.heightTaskItem/2-g-3)+"px;width:"+1+"px;left:"+(f+k-50)+"px;top:"+(g+this.Chart.heightTaskItem)+"px;";e.style.cssText="height:1px;border-color: #4A8F43;border-style: solid;border-width: 1px 0px 0px 0px;margin: 0px; padding: 0px;z-index:0;position: absolute;"+"width:"+(45+(h-(k+f)))+"px;left:"+(f+k-50)+"px;top:"+(i+2)+"px;";c.style.cssText="margin: 0px; padding: 0px;width:7px;height:14px;position: absolute;left:"+(h-7)+"px;top:"+(i-1)+"px;"}else{d.style.cssText="border-width: 0px 0px 0px 1px; border-style: solid; border-color: #4A8F43;margin: 0px; padding: 0px;z-index:0;font-size: 1px;position: absolute;"+"height:"+(g+2-i)+"px;width:"+1+"px;left:"+(f+k-50)+"px;top:"+(i+2)+"px;";e.style.cssText="height:1px;border-color: #4A8F43;border-style: solid;border-width: 1px 0px 0px 0px;margin: 0px; padding: 0px;z-index:0;position: absolute;"+"width:"+(45+(h-(k+f)))+"px;left:"+(f+k-50)+"px;top:"+(i+2)+"px;";c.style.cssText="margin: 0px; padding: 0px;width:7px;height:14px;position: absolute;left:"+(h-7)+"px;top:"+(i-1)+"px;"}a.appendChild(d);a.appendChild(e);a.appendChild(c);b.push(d);b.push(c);b.push(e);return b};GanttTask.prototype.showChildTasks=function(a,b){if(b){for(var i=0;i<a.childTask.length;i++){if(a.childTask[i].cTaskItem[0].style.display=="none"){a.childTask[i].cTaskItem[0].style.display="inline";a.childTask[i].cTaskNameItem[0].style.display="inline";if(this.Chart.isShowDescTask){a.childTask[i].showDescTask()}a.isHide=false;if(a.childTask[i].cTaskNameItem[2]){a.childTask[i].cTaskNameItem[2].style.display="inline";b=a.childTask[i]._isOpen}for(var k=0;k<a.childTask[i].cTaskItem[1].length;k++){a.childTask[i].cTaskItem[1][k].style.display="inline"}for(var k=0;k<a.childTask[i].cTaskNameItem[1].length;k++){a.childTask[i].cTaskNameItem[1][k].style.display="inline"}this._heightHideTasks+=this.Chart.heightTaskItem+11;if(a.childTask[i].childTask.length>0){this.showChildTasks(a.childTask[i],b)}}}}};GanttTask.prototype.hideChildTasks=function(a){for(var i=0;i<a.childTask.length;i++){if(a.childTask[i].cTaskItem[0].style.display!="none"){a.childTask[i].cTaskItem[0].style.display="none";a.childTask[i].cTaskNameItem[0].style.display="none";if(this.Chart.isShowDescTask){a.childTask[i].hideDescTask()}a.isHide=true;if(a.childTask[i].cTaskNameItem[2]){a.childTask[i].cTaskNameItem[2].style.display="none"}for(var k=0;k<a.childTask[i].cTaskItem[1].length;k++){a.childTask[i].cTaskItem[1][k].style.display="none"}for(var k=0;k<a.childTask[i].cTaskNameItem[1].length;k++){a.childTask[i].cTaskNameItem[1][k].style.display="none"}this._heightHideTasks+=this.Chart.heightTaskItem+11;if(a.childTask[i].childTask.length>0){this.hideChildTasks(a.childTask[i])}}}};GanttTask.prototype.shiftCurrentTasks=function(a,b){this.shiftNextTask(this,b);a.Project.shiftNextProject(a.Project,b)};GanttProject.prototype.shiftNextProject=function(a,b){if(a.nextProject){a.nextProject.shiftProject(b);this.shiftNextProject(a.nextProject,b)}};GanttProject.prototype.shiftProject=function(a){this.projectItem[0].style.top=parseInt(this.projectItem[0].style.top)+a+"px";if(this.Chart.isShowDescProject){this.descrProject.style.top=parseInt(this.descrProject.style.top)+a+"px"}if(this.Chart._showTreePanel){this.projectNameItem.style.top=parseInt(this.projectNameItem.style.top)+a+"px"}if(this.arrTasks.length>0)this.shiftNextParentTask(this.arrTasks[0],a)};GanttProject.prototype.shiftTask=function(a,b){if(this.Chart._showTreePanel){a.cTaskNameItem[0].style.top=parseInt(a.cTaskNameItem[0].style.top)+b+"px";if(a.cTaskNameItem[2]){a.cTaskNameItem[2].style.top=parseInt(a.cTaskNameItem[2].style.top)+b+"px"}if(a.parentTask&&a.cTaskNameItem[1][0]){a.cTaskNameItem[1][0].style.top=parseInt(a.cTaskNameItem[1][0].style.top)+b+"px";a.cTaskNameItem[1][1].style.top=parseInt(a.cTaskNameItem[1][1].style.top)+b+"px"}}a.cTaskItem[0].style.top=parseInt(a.cTaskItem[0].style.top)+b+"px";if(this.Chart.isShowDescTask){a.descrTask.style.top=parseInt(a.descrTask.style.top)+b+"px"}if(a.cTaskItem[1][0]){a.cTaskItem[1][0].style.top=parseInt(a.cTaskItem[1][0].style.top)+b+"px";a.cTaskItem[1][1].style.top=parseInt(a.cTaskItem[1][1].style.top)+b+"px";a.cTaskItem[1][2].style.top=parseInt(a.cTaskItem[1][2].style.top)+b+"px"}};GanttProject.prototype.shiftNextParentTask=function(a,b){this.shiftTask(a,b);this.shiftChildTasks(a,b);if(a.nextParentTask){this.shiftNextParentTask(a.nextParentTask,b)}};GanttProject.prototype.shiftChildTasks=function(a,b){for(var i=0;i<a.childTask.length;i++){this.shiftTask(a.childTask[i],b);if(a.childTask[i].childTask.length>0){this.shiftChildTasks(a.childTask[i],b)}}};GanttTask.prototype.shiftTask=function(a,b){if(this.Chart._showTreePanel){a.cTaskNameItem[0].style.top=parseInt(a.cTaskNameItem[0].style.top)+b+"px";if(a.cTaskNameItem[2]){a.cTaskNameItem[2].style.top=parseInt(a.cTaskNameItem[2].style.top)+b+"px"}if(a.parentTask){if(a.cTaskNameItem[1].length>0)if((parseInt(this.cTaskNameItem[0].style.top)>parseInt(a.parentTask.cTaskNameItem[0].style.top))&&(a.cTaskNameItem[1][0].style.display!="none")){a.cTaskNameItem[1][0].style.height=parseInt(a.cTaskNameItem[1][0].style.height)+b+"px"}else{a.cTaskNameItem[1][0].style.top=parseInt(a.cTaskNameItem[1][0].style.top)+b+"px"}if(a.cTaskNameItem[1].length>1)a.cTaskNameItem[1][1].style.top=parseInt(a.cTaskNameItem[1][1].style.top)+b+"px"}}a.cTaskItem[0].style.top=parseInt(a.cTaskItem[0].style.top)+b+"px";if(this.Chart.isShowDescTask){a.descrTask.style.top=parseInt(a.descrTask.style.top)+b+"px"}if(a.predTask){if(a.cTaskItem[1].length>0)if(((parseInt(this.cTaskItem[0].style.top)>parseInt(a.predTask.cTaskItem[0].style.top))||(this.cTaskItem[0].id==a.predTask.TaskInfo.Id))&&a.cTaskItem[1][0].style.display!="none"){a.cTaskItem[1][0].style.height=parseInt(a.cTaskItem[1][0].style.height)+b+"px"}else{a.cTaskItem[1][0].style.top=parseInt(a.cTaskItem[1][0].style.top)+b+"px"}if(a.cTaskItem[1].length>2){a.cTaskItem[1][1].style.top=parseInt(a.cTaskItem[1][1].style.top)+b+"px";a.cTaskItem[1][2].style.top=parseInt(a.cTaskItem[1][2].style.top)+b+"px"}}};GanttTask.prototype.shiftNextTask=function(a,b){if(a.nextChildTask){this.shiftTask(a.nextChildTask,b);this.shiftChildTask(a.nextChildTask,b);this.shiftNextTask(a.nextChildTask,b)}else if(a.parentTask){this.shiftNextTask(a.parentTask,b)}else if(a.nextParentTask){this.shiftTask(a.nextParentTask,b);this.shiftChildTask(a.nextParentTask,b);this.shiftNextTask(a.nextParentTask,b)}};GanttTask.prototype.shiftChildTask=function(a,b){for(var i=0;i<a.childTask.length;i++){this.shiftTask(a.childTask[i],b);if(a.childTask[i].childTask.length>0){this.shiftChildTask(a.childTask[i],b)}}};GanttChart.prototype.getPosOnDate=function(a){return(a-this.startDate)/(60*60*1000)*this.hourInPixels};GanttChart.prototype.getWidthOnDuration=function(a){return Math.round(this.hourInPixelsWork*a)};GanttTask.prototype.endMove=function(){var a=parseInt(this.cTaskItem[0].style.left)-this.posX;var b=this.getDateOnPosition(parseInt(this.cTaskItem[0].style.left));b=this.checkPos(b);this.wasMoved=this.TaskInfo.EST.valueOf()!=b.valueOf();if(this.checkMove){a=this.Chart.getPosOnDate(b)-this.posX;this.moveCurrentTaskItem(a,this.moveChild);this.Project.shiftProjectItem()}this.checkMove=false;this.posX=0;this.maxPosXMove=-1;this.minPosXMove=-1;this.cTaskItem[0].childNodes[1].firstChild.rows[0].cells[0].innerHTML="";if(this.Chart._isFF)document.body.style.cursor="";if(this.Chart._isIE)this.cTaskItem[0].childNodes[2].childNodes[0].style.cursor=""};GanttTask.prototype.checkPos=function(a){var h=a.getHours();if(h>=12){a.setDate(a.getDate()+1);a.setHours(0);if((parseInt(this.cTaskItem[0].firstChild.firstChild.width)+this.Chart.getPosOnDate(a)>this.maxPosXMove)&&(this.maxPosXMove!=-1)){a.setDate(a.getDate()-1);a.setHours(0)}}else if((h<12)&&(h!=0)){a.setHours(0);if((this.Chart.getPosOnDate(a)<this.minPosXMove)){a.setDate(a.getDate()+1)}}this.cTaskItem[0].style.left=this.Chart.getPosOnDate(a)+"px";return a};GanttTask.prototype.getMaxPosPredChildTaskItem=function(){var a=0;var b=0;for(var i=0;i<this.childPredTask.length;i++){b=this.getMaxPosPredChildTaskItemInTree(this.childPredTask[i]);if(b>a){a=b}}return a};GanttTask.prototype.getMaxPosPredChildTaskItemInTree=function(a){var b=parseInt(a.cTaskItem[0].firstChild.firstChild.width)+parseInt(a.cTaskItem[0].style.left);var c=0;var d=0;for(var i=0;i<a.childPredTask.length;i++){d=this.getMaxPosPredChildTaskItemInTree(a.childPredTask[i]);if(d>c){c=d}}if(c>b){return c}else{return b}};GanttProject.prototype.getTaskById=function(a){for(var i=0;i<this.arrTasks.length;i++){var b=this.searchTaskInTree(this.arrTasks[i],a);if(b)return b}return null};GanttProject.prototype.searchTaskInTree=function(a,b){if(a.TaskInfo.Id==b){return a}else{for(var i=0;i<a.childTask.length;i++){if(a.childTask[i].TaskInfo.Id==b){return a.childTask[i]}else{if(a.childTask[i].childTask.length>0){var c=this.searchTaskInTree(a.childTask[i],b);if(c)return c}}}}return null};GanttProject.prototype.shiftProjectItem=function(){var a=null;var b=null;var c=parseInt(this.projectItem[0].style.left);var d=parseInt(this.projectItem[0].firstChild.style.width)+parseInt(this.projectItem[0].style.left);var e=parseInt(this.projectItem[0].firstChild.style.width);for(var t=0;t<this.arrTasks.length;t++){var f=parseInt(this.arrTasks[t].cTaskItem[0].style.left);var g=parseInt(this.arrTasks[t].cTaskItem[0].style.left)+parseInt(this.arrTasks[t].cTaskItem[0].firstChild.firstChild.width);if(!a){a=f}if(!b){b=g}if(a>f){a=f}if(b<g){b=g}}if(a!=c){this.Project.StartDate=new Date(this.Chart.startDate);this.Project.StartDate.setHours(this.Project.StartDate.getHours()+(a/this.Chart.hourInPixels))}this.projectItem[0].style.left=a+"px";this.resizeProjectItem(b-a);this.Duration=Math.round(parseInt(this.projectItem[0].firstChild.width)/(this.Chart.hourInPixelsWork));if(this.Chart.isShowDescProject){this.moveDescrProject()}this.addDayInPanelTime()};GanttProject.prototype.addDayInPanelTime=function(){var a=parseInt(this.projectItem[0].style.left)+parseInt(this.projectItem[0].firstChild.style.width)+20;if(this.Chart.isShowDescProject){a+=this.descrProject.offsetWidth}var b=this.Chart.panelTime.firstChild,tbody=b.firstChild;if(parseInt(tbody.offsetWidth)<a){var c=Math.round((a-parseInt(tbody.offsetWidth))/this.Chart.dayInPixels);var d=tbody.rows[1];for(var n=0;n<c;n++){this.Chart.addPointInTimePanel(d,b);this.Chart.addDayInPanelTime(d)}var w=this.Chart.dayInPixels*(d.cells.length);tbody.style.width=w+"px";this.Chart.panelTasks.style.width=(w-18)+"px"}};GanttProject.prototype.addEvent=function(a,b,c,d){if(a.addEventListener){a.addEventListener(b,c,d);return true}else if(a.attachEvent){return a.attachEvent('on'+b,c)}else{a['on'+b]=c}};GanttProject.prototype.getPopUpInfo=function(a,b){var c=a.offsetLeft+((b.layerX==null)?b.offsetX:b.layerX);var d=a.offsetTop+this.Chart.heightTaskItem+6;var e=this.Chart.divInfo.lastChild;e.rows[0].cells[0].innerHTML="<div style='font-family: Arial, Helvetica, Sans-serif; font-size: 12px; font-weight: bold; color: #688060; margin:0 0 4px 0;'>"+this.Project.Name+"</div>";e.rows[0].cells[0].innerHTML+="<span class='st'>Start Date:&nbsp;</span><span class='ut'>"+(this.Project.StartDate.getMonth()+1)+"."+this.Project.StartDate.getDate()+"."+this.Project.StartDate.getFullYear()+"</span><br/>";e.rows[0].cells[0].innerHTML+="<span class='st'>Duration:&nbsp;</span><span class='ut'>"+this.Duration+" hours</span><br/>";e.rows[0].cells[0].innerHTML+="<span class='st'>Percent Complete:&nbsp;</span><span class='ut'>"+this.percentCompleted+"%</span><br/>";this.Chart.divInfo.style.cssText="z-index:2;position: absolute;display: inline;";if(d+this.Chart.divInfo.lastChild.offsetHeight+6>this.Chart.oData.offsetHeight+this.Chart.oData.scrollTop){this.Chart.divInfo.style.top=(d-this.Chart.divInfo.lastChild.offsetHeight-10-this.Chart.heightTaskItem)+"px"}else{this.Chart.divInfo.style.top=d+"px"}if(this.Chart.divInfo.lastChild.offsetWidth+c+10>this.Chart.oData.offsetWidth+this.Chart.oData.scrollLeft){this.Chart.divInfo.style.left=c-(this.Chart.divInfo.lastChild.offsetWidth+c+20-(this.Chart.oData.offsetWidth+this.Chart.oData.scrollLeft))+"px"}else{this.Chart.divInfo.style.left=c+"px"}};GanttProject.prototype.closePopUpInfo=function(){this.Chart.divInfo.style.display="none"};GanttProject.prototype.resizeProjectItem=function(a){var b=this.percentCompleted;if(b>0&&b<100){this.projectItem[0].firstChild.style.width=a+"px";this.projectItem[0].firstChild.width=a+"px";this.projectItem[0].style.width=a+"px";this.projectItem[0].firstChild.rows[0].cells[0].firstChild.style.width=Math.round(a*b/100)+"px";this.projectItem[0].firstChild.rows[0].cells[1].firstChild.style.width=Math.round(a*(100-b)/100)+"px";this.projectItem[0].lastChild.firstChild.width=a+"px"}else if(b==0||b==100){this.projectItem[0].firstChild.style.width=a+"px";this.projectItem[0].firstChild.width=a+"px";this.projectItem[0].style.width=a+"px";this.projectItem[0].firstChild.rows[0].cells[0].firstChild.style.width=a+"px";this.projectItem[0].lastChild.firstChild.width=a+"px"}};GanttTask.prototype.moveCurrentTaskItem=function(a,b){var c=this.cTaskItem[0];this.TaskInfo.EST=new Date(this.Chart.startDate);this.TaskInfo.EST.setHours(this.TaskInfo.EST.getHours()+(parseInt(c.style.left)/this.Chart.hourInPixels));if(this.Chart.isShowDescTask){this.showDescTask()}if(this.cTaskItem[1].length>0){this.cTaskItem[1][2].style.width=parseInt(this.cTaskItem[1][2].style.width)+a+"px";this.cTaskItem[1][1].style.left=parseInt(this.cTaskItem[1][1].style.left)+a+"px"}for(var i=0;i<this.childTask.length;i++){if(!this.childTask[i].predTask){this.moveChildTaskItems(this.childTask[i],a,b)}}for(var i=0;i<this.childPredTask.length;i++){this.moveChildTaskItems(this.childPredTask[i],a,b)}};GanttTask.prototype.moveChildTaskItems=function(a,b,c){var d=a.cTaskItem[0];if(c){d.style.left=parseInt(d.style.left)+b+"px";a.addDayInPanelTime();a.TaskInfo.EST=new Date(this.Chart.startDate);a.TaskInfo.EST.setHours(a.TaskInfo.EST.getHours()+(parseInt(d.style.left)/this.Chart.hourInPixels));for(var n=0;n<a.cTaskItem[1].length;n++){a.cTaskItem[1][n].style.left=parseInt(a.cTaskItem[1][n].style.left)+b+"px"}for(var i=0;i<a.childTask.length;i++){if(!a.childTask[i].predTask){this.moveChildTaskItems(a.childTask[i],b,c)}}for(var i=0;i<a.childPredTask.length;i++){this.moveChildTaskItems(a.childPredTask[i],b,c)}}else{if(a.cTaskItem[1].length>0){a.cTaskItem[1][2].style.left=parseInt(a.cTaskItem[1][2].style.left)+b+"px";a.cTaskItem[1][2].style.width=parseInt(a.cTaskItem[1][2].style.width)-b+"px";a.cTaskItem[1][0].style.left=parseInt(a.cTaskItem[1][0].style.left)+b+"px"}}if(this.Chart.isShowDescTask){a.moveDescTask()}};GanttTask.prototype.addDayInPanelTime=function(){var a=this.cTaskItem[0];var b=parseInt(a.style.left)+parseInt(a.firstChild.firstChild.width)+20;if(this.Chart.isShowDescTask){b+=this.descrTask.offsetWidth}var c=this.Chart.panelTime.firstChild,tbody=c.firstChild;if(parseInt(tbody.offsetWidth)<b){var d=tbody.rows[1];var e=Math.round((b+20-parseInt(tbody.offsetWidth))/this.Chart.dayInPixels);for(var n=0;n<e;n++){this.Chart.addPointInTimePanel(d,c);this.Chart.addDayInPanelTime(d)}var w=this.Chart.dayInPixels*(d.cells.length);tbody.style.width=w+"px";this.Chart.panelTasks.style.width=(w-18)+"px"}};GanttTask.prototype.getDateOnPosition=function(a){var b=new Date(this.Chart.startDate);b.setHours(b.getHours()+(a/this.Chart.hourInPixels));return b};GanttTask.prototype.moveItem=function(a){var b=a.screenX;var c=(this.posX+(b-this.MouseX));var d=parseInt(this.cTaskItem[0].childNodes[0].firstChild.width);var e=c+d;if(this.checkMove){var f=this.getDateOnPosition(c);var g=this.Chart.callEvent("onTaskDragging",[this,f])!==false;if(g&&((this.minPosXMove<=c))&&((e<=this.maxPosXMove)||(this.maxPosXMove==-1))){this.moveTaskItem(c)}}};GanttTask.prototype.moveTaskItem=function(a){this.addDayInPanelTime();this.cTaskItem[0].style.left=a+"px";var b=this.getDateOnPosition(a);this.cTaskItem[0].childNodes[1].firstChild.rows[0].cells[0].innerHTML=(b.getMonth()+1)+'.'+b.getDate()+'.'+b.getUTCFullYear()};GanttTask.prototype.resizeItem=function(a){if(this.checkResize){var b=a.screenX;var c=this.taskItemWidth+(b-this.MouseX);var d=Math.round(c/this.Chart.hourInPixelsWork);if(this.Chart.callEvent("onTaskResizing",[this,d])===false)return;if(c>=this.taskItemWidth){if((c<=this.maxWidthResize)||(this.maxWidthResize==-1)){this.resizeTaskItem(c);this.addDayInPanelTime()}else if((this.maxWidthResize!=-1)&&(c>this.maxWidthResize)){this.resizeTaskItem(this.maxWidthResize)}}else if(c<=this.taskItemWidth){if(c>=this.minWidthResize){this.resizeTaskItem(c)}else if(c<this.minWidthResize){this.resizeTaskItem(this.minWidthResize)}}}};GanttTask.prototype.resizeTaskItem=function(a){var b=this.cTaskItem[0];var d=Math.round(a/this.Chart.hourInPixelsWork);var c=b.childNodes[0].firstChild.rows[0].cells[0];if(c){c.firstChild.style.width=parseInt(c.width)*a/100+"px"}c=b.childNodes[0].firstChild.rows[0].cells[1];if(c){c.firstChild.style.width=parseInt(c.width)*a/100+"px"}b.childNodes[0].firstChild.width=a+"px";b.childNodes[1].firstChild.width=a+"px";this.cTaskItem[0].childNodes[1].firstChild.rows[0].cells[0].innerHTML=d;b.childNodes[2].childNodes[0].style.width=a+"px";b.childNodes[2].childNodes[1].style.left=a-10+"px"};GanttTask.prototype.endResizeItem=function(){var a=this.cTaskItem[0];this.wasResized=this.taskItemWidth!=parseInt(a.childNodes[0].firstChild.width);if(this.wasResized){var b=a.offsetLeft;var c=a.offsetLeft+parseInt(a.childNodes[0].firstChild.width);this.TaskInfo.Duration=Math.round((c-b)/this.Chart.hourInPixelsWork);if(this.childPredTask.length>0){for(var j=0;j<this.childPredTask.length;j++){this.childPredTask[j].cTaskItem[1][2].style.width=parseInt(this.childPredTask[j].cTaskItem[1][2].style.width)-(parseInt(a.childNodes[0].firstChild.width)-this.taskItemWidth)+"px";this.childPredTask[j].cTaskItem[1][2].style.left=parseInt(this.childPredTask[j].cTaskItem[1][2].style.left)+(parseInt(a.childNodes[0].firstChild.width)-this.taskItemWidth)+"px";this.childPredTask[j].cTaskItem[1][0].style.left=parseInt(this.childPredTask[j].cTaskItem[1][0].style.left)+(parseInt(a.childNodes[0].firstChild.width)-this.taskItemWidth)+"px"}}}this.cTaskItem[0].childNodes[1].firstChild.rows[0].cells[0].innerHTML="";this.checkResize=false;this.taskItemWidth=0;this.MouseX=0;if(this.Chart.isShowDescTask){this.showDescTask()}this.Project.shiftProjectItem();if(this.Chart._isFF)document.body.style.cursor=""};GanttProject.prototype.moveDescrProject=function(){this.descrProject.style.left=(parseInt(this.projectItem[0].style.left)+this.Duration*this.Chart.hourInPixelsWork+10);this.descrProject.innerHTML=this.getDescStr()};GanttProject.prototype.showDescrProject=function(){var a=(parseInt(this.projectItem[0].style.left)+this.Duration*this.Chart.hourInPixelsWork+10);this.descrProject.style.left=a+"px";this.descrProject.style.visibility='visible';this.descrProject.innerHTML=this.getDescStr()};GanttProject.prototype.hideDescrProject=function(){this.descrProject.style.visibility='hidden'};GanttProject.prototype.getDescStr=function(){var a='',delim=", ";for(var i=0;i<this.Chart.paramShowProject.length;i++){switch(this.Chart.paramShowProject[i]){case"Name":if(a!="")a+=delim;a+=this.Project[this.Chart.paramShowProject[i]];break;case"StartDate":if(a!="")a+=delim;var d=this.Project[this.Chart.paramShowProject[i]];a+=(d.getMonth()+1)+"."+d.getDate()+"."+d.getFullYear();break;case"Duration":if(a!="")a+=delim;a+=(this[this.Chart.paramShowProject[i]]/24)+" days";break;case"percentCompleted":if(a!="")a+=delim;a+=this[this.Chart.paramShowProject[i]]+"%";break;default:break}}return a};GanttProject.prototype.createDescrProject=function(){var a=(this.posX+this.Duration*this.Chart.hourInPixelsWork+10);var b=document.createElement("div");b.style.cssText+=";z-index:1;position:absolute;left:"+a+"px;top:"+this.posY+"px;";b.innerHTML=this.getDescStr();b.className="descProject";this.descrProject=b;if(this.Project.ParentTasks.length==0){this.descrProject.style.visibility='hidden'}if(this.Chart._showTooltip){var c=this;var d=function(e){if((!c.Chart._isMove)&&(!c.Chart._isResize))c.getPopUpInfo(c.descrProject,e)};var f=function(){c.closePopUpInfo()};this.addEvent(b,'mouseover',d,false);this.addEvent(b,'mouseout',f,false)}return b};GanttProject.prototype.createProjectItem=function(){var a=this;this.percentCompleted=this.getPercentCompleted();this.Duration=this.getDuration();var b=document.createElement("div");b.id=this.Project.Id;b.style.cssText=";z-index:1;position: absolute;left:"+this.posX+"px;top:"+this.posY+"px;";b.style.width=this.Duration*this.Chart.hourInPixelsWork+"px";var c=document.createElement("table");b.appendChild(c);c.cellPadding="0";c.cellSpacing="0";c.style.cssText="border: solid 1px #EC1C23;";var d=this.Duration*this.Chart.hourInPixelsWork;c.width=((d==0)?1:d)+"px";c.style.width=((d==0)?1:d)+"px";var f=c.insertRow(c.rows.length);if(this.percentCompleted!=-1){if(this.percentCompleted!=0){var g=document.createElement("TD");f.appendChild(g);g.width=this.percentCompleted+"%";g.style.lineHeight="1px";var h=document.createElement("img");h.style.width=(this.percentCompleted*this.Duration*this.Chart.hourInPixelsWork)/100+"px";h.style.height=this.Chart.heightTaskItem+"px";g.appendChild(h);h.src=this.Chart.imgs+"parentnode_filled.png"}if(this.percentCompleted!=100){var g=document.createElement("TD");f.appendChild(g);g.width=(100-this.percentCompleted)+"%";g.style.lineHeight="1px";var h=document.createElement("img");h.style.width=((100-this.percentCompleted)*this.Duration*this.Chart.hourInPixelsWork)/100+"px";h.style.height=this.Chart.heightTaskItem+"px";g.appendChild(h);h.src=this.Chart.imgs+"progress_bg.png"}}else{var g=document.createElement("TD");f.appendChild(g);g.width="1px";g.style.lineHeight="1px";var h=document.createElement("img");h.style.width="1px";h.style.height=this.Chart.heightTaskItem;g.appendChild(h);h.src=this.Chart.imgs+"progress_bg.png"}var i=document.createElement("div");i.style.cssText="text-align:center;z-index:2;position:absolute;left:0px;top:0px;";var j=document.createElement("table");i.appendChild(j);j.cellPadding="0";j.cellSpacing="0";j.height=this.Chart.heightTaskItem+"px";j.width=((this.Duration*this.Chart.hourInPixelsWork==0)?1:this.Duration*this.Chart.hourInPixelsWork)+"px";var k=j.insertRow(0);var l=document.createElement("td");l.align="center";l.vAlign="top";l.height=this.Chart.heightTaskItem+"px";l.className="moveInfo";l.style.cssText=";white-space:nowrap;";k.appendChild(l);b.appendChild(i);if(this.Project.ParentTasks.length==0){b.style.display="none"}if(this.Chart._showTooltip){var m=function(e){if((!a.Chart._isMove)&&(!a.Chart._isResize))a.getPopUpInfo(a.projectItem[0],e)};var n=function(){a.closePopUpInfo()};this.addEvent(i,'mouseover',m,false);this.addEvent(i,'mouseout',n,false)}return b};GanttProject.prototype.createProjectNameItem=function(){var c=this;var d=document.createElement("div");d.style.cssText="cursor:pointer;color:#000000;font-weight:bold;font-size:12px;font-family:Tahoma,Arial;white-space:nowrap;height:15px;z-index:1;position:absolute;left:"+5+"px;top:"+this.posY+"px;";d.innerHTML=this.Project.Name;d.title=this.Project.Name;if(this.Chart.isShowConMenu){var f=function(a){if(c.Chart.contextMenu.clear)c.Chart.contextMenu.clear();var b=null;if(!c.Chart._isIE){b=function(){c.Chart.contextMenu.hideContextMenu();c.Chart.content.removeEventListener("mousedown",b,false)}}else{b=function(){c.Chart.contextMenu.hideContextMenu();c.Chart.content.detachEvent("mousedown",b)}}c.Chart.content.onmousedown=b;if(!c.Chart._isIE){a.stopPropagation()}else{a.cancelBubble=true}c.Chart._showContextMenu(a,c)};if(this.Chart._isIE){this.addEvent(d,"contextmenu",function(e){f(e);return false},false)}else{this.addEvent(d,"contextmenu",function(e){e.preventDefault();f(e)},false)}}return d};GanttProject.prototype.getPercentCompleted=function(){var a=0;var b=0;for(var i=0;i<this.Project.ParentTasks.length;i++){a+=parseInt(this.Project.ParentTasks[i].PercentCompleted)}if(this.Project.ParentTasks.length!=0){return b=Math.round(a/this.Project.ParentTasks.length)}else{return b=-1}};GanttProject.prototype.getDuration=function(){var a=0;var b=0;if(this.Project.ParentTasks.length>0){for(var i=0;i<this.Project.ParentTasks.length;i++){b=this.Project.ParentTasks[i].Duration*24/this.Chart.hoursInDay+(this.Project.ParentTasks[i].EST-this.Chart.startDate)/(60*60*1000);if(b>a){a=b}}return((a-this.posX)/24)*this.Chart.hoursInDay}else{return 0}};GanttProject.prototype.getId=function(){return this.Project.Id};GanttProject.prototype.getName=function(){return this.Project.Name};GanttProject.prototype.getStartDate=function(){return this.Project.StartDate};GanttTask.prototype.addEvent=function(a,b,c,d){if(a.addEventListener){a.addEventListener(b,c,d);return true}else if(a.attachEvent){return a.attachEvent('on'+b,c)}else{a['on'+b]=c}};GanttTask.prototype.startMove=function(a){this.moveChild=a.ctrlKey;this.MouseX=a.screenX;this.getMoveInfo();this.checkMove=true;if(this.Chart.isShowDescTask){this.hideDescTask()}if(this.Chart._isFF)document.body.style.cursor="move";if(this.Chart._isIE)a.srcElement.style.cursor="move"};GanttTask.prototype.showDescTask=function(){var a=(parseInt(this.cTaskItem[0].style.left)+this.TaskInfo.Duration*this.Chart.hourInPixelsWork+10);this.descrTask.style.left=a+"px";this.descrTask.innerHTML=this.getDescStr();this.descrTask.style.visibility='visible'};GanttTask.prototype.hideDescTask=function(){this.descrTask.style.visibility='hidden'};GanttTask.prototype.getDescStr=function(){var a='',delim=", ";for(var i=0;i<this.Chart.paramShowTask.length;i++){var b=this.Chart.paramShowTask[i],propValue=this.TaskInfo[b];switch(b){case"Name":if(a!="")a+=delim;a+=propValue;break;case"EST":if(a!="")a+=delim;a+=(propValue.getMonth()+1)+"."+propValue.getDate()+"."+propValue.getFullYear();break;case"S-F":if(a!="")a+=delim;propValue=this.TaskInfo["EST"];a+=(propValue.getMonth()+1)+"."+propValue.getDate()+"."+propValue.getFullYear()+" - ";propValue=this.getFinishDate();a+=(propValue.getMonth()+1)+"."+propValue.getDate()+"."+propValue.getFullYear();break;case"Duration":if(a!="")a+=delim;a+=(propValue/24).toFixed(1)+" days";break;case"PercentCompleted":if(a!="")a+=delim;a+=propValue+"%";break;default:break}}return a};GanttTask.prototype.getId=function(){return this.TaskInfo.Id};GanttTask.prototype.getName=function(){return this.TaskInfo.Name};GanttTask.prototype.getDuration=function(){return this.TaskInfo.Duration};GanttTask.prototype.getEST=function(){return this.TaskInfo.EST};GanttTask.prototype.getFinishDate=function(){var a=new Date(this.TaskInfo.EST);a.setDate(a.getDate()+parseInt((this.TaskInfo["Duration"]-1)/this.Chart.hoursInDay+1)-1);return a};GanttTask.prototype.getPercentCompleted=function(){return this.TaskInfo.PercentCompleted};GanttTask.prototype.getPredecessorTaskId=function(){return this.TaskInfo.PredecessorTaskId?this.TaskInfo.PredecessorTaskId:null};GanttTask.prototype.getParentTaskId=function(){return this.parentTask?this.parentTask.getId():null};GanttTask.prototype.moveDescTask=function(){var a=(parseInt(this.cTaskItem[0].style.left)+this.TaskInfo.Duration*this.Chart.hourInPixelsWork+10);this.descrTask.style.left=a+"px"};GanttTask.prototype.getMoveInfo=function(){this.posX=parseInt(this.cTaskItem[0].style.left);var a=parseInt(this.cTaskItem[0].childNodes[0].firstChild.width);var b=(this.parentTask==null)?0:parseInt(this.parentTask.cTaskItem[0].style.left);var c=(this.predTask==null)?0:parseInt(this.predTask.cTaskItem[0].style.left)+parseInt(this.predTask.cTaskItem[0].childNodes[0].firstChild.width);var d=(this.parentTask==null)?0:parseInt(this.parentTask.cTaskItem[0].childNodes[0].firstChild.width);var e=0;var f=0;var g=0;if(this.childPredTask.length>0){var h=null;for(var n=0;n<this.childPredTask.length;n++){if((!h)||((h)&&(h>parseInt(this.childPredTask[n].cTaskItem[0].style.left)))){h=parseInt(this.childPredTask[n].cTaskItem[0].style.left)}}e=h}if(this.childTask.length>0){var i=null;for(var n=0;n<this.childTask.length;n++){if((!i)||((i)&&(i>(parseInt(this.childTask[n].cTaskItem[0].style.left))))){i=parseInt(this.childTask[n].cTaskItem[0].style.left)}}g=i;var h=null;for(var n=0;n<this.childTask.length;n++){if((!h)||((h)&&(h<(parseInt(this.childTask[n].cTaskItem[0].style.left)+parseInt(this.childTask[n].cTaskItem[0].firstChild.firstChild.width))))){h=parseInt(this.childTask[n].cTaskItem[0].style.left)+parseInt(this.childTask[n].cTaskItem[0].firstChild.firstChild.width)}}f=h}if(!this.moveChild){if(this.childPredTask.length>0){if(this.maxPosXMove<e)this.maxPosXMove=e}if(this.childTask.length>0){if((this.childPredTask.length>0)&&(this.maxPosXMove-a)>g)this.maxPosXMove=this.maxPosXMove-((this.maxPosXMove-a)-g);if(!(this.childPredTask.length>0))this.maxPosXMove=g+a;this.minPosXMove=(f-a)}if(b>0){if((!(this.childPredTask.length>0))&&(this.childTask.length>0)){if(this.maxPosXMove>b+d){this.maxPosXMove=b+d}}if(this.minPosXMove<=b){this.minPosXMove=b}if((!(this.childTask.length>0))&&(!(this.childPredTask.length>0))){this.maxPosXMove=b+d}else if((!(this.childTask.length>0))&&(this.childPredTask.length>0)){if((b+d)>c){this.maxPosXMove=e}}}if(c>0){if(this.minPosXMove<=c){this.minPosXMove=c}}if((c==0)&&(b==0)){if(this.minPosXMove<=this.Chart.initialPos){this.minPosXMove=this.Chart.initialPos}}}else{if((b>0)&&(c==0)){this.minPosXMove=b;this.maxPosXMove=b+d}else if((b==0)&&(c==0)){this.minPosXMove=this.Chart.initialPos;this.maxPosXMove=-1}else if((b>0)&&(c>0)){this.minPosXMove=c;this.maxPosXMove=b+d}else if((b==0)&&(c>0)){this.minPosXMove=c;this.maxPosXMove=-1}if((this.parentTask)&&(this.childPredTask.length>0)){var h=this.getMaxPosPredChildTaskItem(this);var b=parseInt(this.parentTask.cTaskItem[0].style.left)+parseInt(this.parentTask.cTaskItem[0].firstChild.firstChild.width);this.maxPosXMove=this.posX+a+b-h}}};GanttTask.prototype.startResize=function(a){this.MouseX=a.screenX;this.getResizeInfo();if(this.Chart.isShowDescTask){this.hideDescTask()}this.checkResize=true;this.taskItemWidth=parseInt(this.cTaskItem[0].firstChild.firstChild.width);if(this.Chart._isFF)document.body.style.cursor="e-resize"};GanttTask.prototype.getResizeInfo=function(){var a=this.cTaskItem[0];var b=(this.parentTask==null)?0:parseInt(this.parentTask.cTaskItem[0].style.left);var c=(this.parentTask==null)?0:parseInt(this.parentTask.cTaskItem[0].childNodes[0].firstChild.width);var d=parseInt(this.cTaskItem[0].style.left);var e=0;var f=0;if(this.childPredTask.length>0){var g=null;for(var n=0;n<this.childPredTask.length;n++){if((!g)||((g)&&(g>parseInt(this.childPredTask[n].cTaskItem[0].style.left)))){g=parseInt(this.childPredTask[n].cTaskItem[0].style.left)}}e=g}if(this.childTask.length>0){var g=null;for(var n=0;n<this.childTask.length;n++){if((!g)||((g)&&(g<(parseInt(this.childTask[n].cTaskItem[0].style.left)+parseInt(this.childTask[n].cTaskItem[0].firstChild.firstChild.width))))){g=parseInt(this.childTask[n].cTaskItem[0].style.left)+parseInt(this.childTask[n].cTaskItem[0].firstChild.firstChild.width)}}f=g}this.minWidthResize=this.Chart.dayInPixels;if(this.childTask.length>0){this.minWidthResize=f-d}if((this.childPredTask.length>0)&&(!this.parentTask)){this.maxWidthResize=e-d}else if((this.childPredTask.length>0)&&(this.parentTask)){var h=b+c-d;var i=e-d;this.maxWidthResize=Math.min(h,i)}else if((this.childPredTask.length==0)&&(this.parentTask)){this.maxWidthResize=b+c-d}};GanttTask.prototype.createTaskItem=function(){var d=this;this.posX=this.Chart.getPosOnDate(this.TaskInfo.EST);var f=document.createElement("div");f.id=this.TaskInfo.Id;f.style.cssText=";z-index:1;position:absolute;left:"+this.posX+"px;top:"+this.posY+"px;";var g=document.createElement("div");f.appendChild(g);g.style.cssText="z-index:1;position: absolute;left:0px;top:0px;";var h=document.createElement("table");g.appendChild(h);h.cellPadding="0";h.cellSpacing="0";h.width=this.TaskInfo.Duration*this.Chart.hourInPixelsWork+"px";h.style.cssText="border: solid 1px #BC810D;";var i=h.insertRow(h.rows.length);if(this.TaskInfo.PercentCompleted!=0){var j=document.createElement("td");i.appendChild(j);j.height=this.Chart.heightTaskItem+"px";j.width=this.TaskInfo.PercentCompleted+"%";j.style.lineHeight="1px";var k=document.createElement("img");k.style.width=(this.TaskInfo.PercentCompleted*this.TaskInfo.Duration*this.Chart.hourInPixelsWork)/100+"px";k.style.height=this.Chart.heightTaskItem+"px";j.appendChild(k);k.src=this.Chart.imgs+"progress_filled.png"}if(this.TaskInfo.PercentCompleted!=100){var j=document.createElement("td");i.appendChild(j);j.height=this.Chart.heightTaskItem+"px";j.width=(100-this.TaskInfo.PercentCompleted)+"%";j.style.lineHeight="1px";var l=document.createElement("img");l.style.width=((100-this.TaskInfo.PercentCompleted)*this.TaskInfo.Duration*this.Chart.hourInPixelsWork)/100+"px";l.style.height=this.Chart.heightTaskItem+"px";j.appendChild(l);l.src=this.Chart.imgs+"progress_bg.png"}if(this.Chart.isEditable){var m=document.createElement("div");m.style.cssText="text-align:center;font-size:9px;z-index:2;position: absolute;left:0px;top:0px;";var n=document.createElement("table");m.appendChild(n);n.cellPadding="0";n.cellSpacing="0";n.height=this.Chart.heightTaskItem+"px";n.width=this.TaskInfo.Duration*this.Chart.hourInPixelsWork+"px";var o=n.insertRow(0);var p=document.createElement("TD");p.align="center";p.vAlign="top";p.height=this.Chart.heightTaskItem+"px";p.className="moveInfo";p.style.cssText=";white-space:nowrap;font-size:9px";o.appendChild(p);f.appendChild(m)}var q=document.createElement("div");f.appendChild(q);q.style.cssText=";z-index:2;position: absolute;left:0px;top:0px;";var r=document.createElement("div");r.innerHTML="<input type='text' style='visibility:hidden;width:1px;height:1px;'/>";if(this.Chart._isIE){r.style.background="#000000";r.style.filter="alpha(opacity=0)"}r.style.height=this.Chart.heightTaskItem+"px";r.style.width=this.TaskInfo.Duration*this.Chart.hourInPixelsWork+"px";q.appendChild(r);if(this.Chart._showTooltip){var s=function(e){if((!d.Chart._isMove)&&(!d.Chart._isResize))d.getPopUpInfo(d.cTaskItem[0],e)};var t=function(){d.closePopUpInfo()};this.addEvent(r,'mouseover',s,false);this.addEvent(r,'mouseout',t,false)}var u=function(){d.Chart.callEvent("onTaskClick",[d])};this.addEvent(r,'click',u,false);if(this.Chart.isEditable){var v=document.createElement("div");v.style.cssText=";z-index:10;position: absolute;left:"+(this.TaskInfo.Duration*this.Chart.hourInPixelsWork-10)+"px;top:0px;";v.style.height=this.Chart.heightTaskItem+"px";v.style.width="10px";v.innerHTML="<input type='text' style='visibility:hidden;width:1px;height:1px;'/>";q.appendChild(v);var w=function(e){if(d.Chart.callEvent("onTaskStartDrag",[d])===false)return;var b=function(a){if(d.checkMove)d.moveItem(a)};var c=function(){if(d.checkMove){d.endMove();d.Chart._isMove=false;if(d.Chart._isIE){document.body.releaseCapture();document.detachEvent("onmousemove",b);document.detachEvent("onmouseup",c)}else{document.removeEventListener("mousemove",b,true);document.removeEventListener("mouseup",c,true)}if(d.wasMoved)d.Chart.callEvent("onTaskEndDrag",[d])}};d.addEvent(document,'mousemove',b,true);d.addEvent(document,'mouseup',c,true);if(d.Chart._showTooltip)d.closePopUpInfo();d.startMove(e);d.Chart._isMove=true;if(d.Chart._isIE)document.body.setCapture(false)};var x=function(e){if(d.Chart.callEvent("onTaskStartResize",[d])===false)return;var b=function(a){if(d.checkResize)d.resizeItem(a)};var c=function(){if(d.checkResize){d.endResizeItem();d.Chart._isResize=false;if(d.Chart._isIE){document.body.releaseCapture();document.detachEvent("onmousemove",b);document.detachEvent("onmouseup",c)}else{document.removeEventListener("mousemove",b,true);document.removeEventListener("mouseup",c,true)}if(d.wasResized)d.Chart.callEvent("onTaskEndResize",[d])}};d.addEvent(document,'mousemove',b,false);d.addEvent(document,'mouseup',c,false);d.startResize(e);if(d.Chart._isIE)document.body.setCapture(false);d.Chart._isResize=true};this.addEvent(r,'mousedown',w,false);this.addEvent(v,'mousedown',x,false);var y=function(a){if(!d.Chart._isMove)(a.srcElement?a.srcElement:a.target).style.cursor="e-resize"};var z=function(a){if(!d.checkResize)(a.srcElement?a.srcElement:a.target).style.cursor=""};this.addEvent(v,'mouseover',y,false);this.addEvent(v,'mouseout',z,false)}return f};GanttTask.prototype.createTaskNameItem=function(c){var d=this;var f=document.createElement("div");f.id=this.TaskInfo.Id;f.style.cssText="cursor:pointer;white-space:nowrap;height:15px;z-index:1;position:absolute;left:20px;top: "+this.posY+"px;";if(c)f.style.fontWeight="bold";f.className="taskNameItem";f.title=this.TaskInfo.Name;f.innerHTML=this.TaskInfo.Name;if(this.Chart.isShowConMenu){var g=function(a){if(d.Chart.contextMenu.clear)d.Chart.contextMenu.clear();var b=function(){d.Chart.contextMenu.hideContextMenu();if(d.Chart._isIE)d.Chart.content.detachEvent("mousedown",b);else d.Chart.content.removeEventListener("mousedown",b,false)};d.Chart.content.onmousedown=b;if(!d.Chart._isIE){a.stopPropagation()}else{a.cancelBubble=true}d.Chart._showContextMenu(a,d)};if(this.Chart._isIE){this.addEvent(f,"contextmenu",function(e){g(e);return false},false)}else{this.addEvent(f,"contextmenu",function(e){e.preventDefault();g(e)},false)}}return f};GanttTask.prototype.createTaskDescItem=function(){var a=(this.posX+this.TaskInfo.Duration*this.Chart.hourInPixelsWork+10);var b=document.createElement("div");b.style.cssText+=";z-index:1;position:absolute;left:"+a+"px;top:"+this.posY+"px;";b.innerHTML=this.getDescStr();b.className="descTask";this.descrTask=b;if(this.Chart._showTooltip){var c=this;var d=function(e){if((!c.Chart._isMove)&&(!c.Chart._isResize))c.getPopUpInfo(c.descrTask,e)};var f=function(){c.closePopUpInfo()};this.addEvent(b,'mouseover',d,false);this.addEvent(b,'mouseout',f,false)}return b};GanttTask.prototype.checkWidthTaskNameItem=function(){var a=this.TaskInfo.Name;if(this.cTaskNameItem[0].offsetWidth+this.cTaskNameItem[0].offsetLeft>this.Chart.maxWidthPanelNames){var b=this.cTaskNameItem[0].offsetWidth+this.cTaskNameItem[0].offsetLeft-this.Chart.maxWidthPanelNames;var c=Math.round(b/(this.cTaskNameItem[0].offsetWidth/this.cTaskNameItem[0].firstChild.length));var a=this.TaskInfo.Name.substring(0,this.cTaskNameItem[0].firstChild.length-c-3);a+="...";this.cTaskNameItem[0].innerHTML=a}var d=this.TaskInfo.Id>30000000?ganttSoftwareContestUrl:ganttContestUrl;this.cTaskNameItem[0].innerHTML="<a href=\""+d+this.TaskInfo.Id+"\">"+"<font color=\"#7D7D7D\">"+a+"</font></a>"};GanttTask.prototype.create=function(){var a=this.Chart.oData.firstChild;var b=null;if(this.Chart._showTreePanel)b=this.Chart.panelNames.firstChild;var c=this.TaskInfo.PredecessorTask;var d=this.TaskInfo.ParentTask;var e=(this.TaskInfo.ChildTasks.length>0);var f=this;this.cTaskItem=[];this.cTaskNameItem=[];if(!d){if(this.TaskInfo.previousParentTask){this.previousParentTask=this.Project.getTaskById(this.TaskInfo.previousParentTask.Id);var g=this.Chart.getLastChildTask(this.previousParentTask);this.posY=parseInt(g.cTaskItem[0].style.top)+this.Chart.heightTaskItem+11;this.previousParentTask.nextParentTask=this}else{this.posY=parseInt(this.Project.projectItem[0].style.top)+this.Chart.heightTaskItem+11}}if(d){var h=this.Project.getTaskById(this.TaskInfo.ParentTask.Id);this.parentTask=h;if(this.TaskInfo.previousChildTask){this.previousChildTask=this.Project.getTaskById(this.TaskInfo.previousChildTask.Id);var g=this.Chart.getLastChildTask(this.previousChildTask);this.posY=parseInt(g.cTaskItem[0].style.top)+this.Chart.heightTaskItem+11;this.previousChildTask.nextChildTask=this}else{this.posY=parseInt(h.cTaskItem[0].style.top)+this.Chart.heightTaskItem+11}h.childTask.push(this)}if(c){var h=this.Project.getTaskById(c.Id);this.predTask=h;h.childPredTask.push(this)}this.cTaskItem.push(this.createTaskItem());a.appendChild(this.cTaskItem[0]);if(this.Chart.panelNames){this.cTaskNameItem.push(this.createTaskNameItem(e));this.Chart.panelNames.firstChild.appendChild(this.cTaskNameItem[0])}if(this.Chart.isShowDescTask){a.appendChild(this.createTaskDescItem())}var i=[];if(c)i=this.createConnectingLinesDS();this.cTaskItem.push(i);if(this.Chart.panelNames){var j=[];if(d){this.cTaskNameItem[0].style.left=parseInt(this.parentTask.cTaskNameItem[0].style.left)+15+"px";j=this.createConnectingLinesPN()}this.checkWidthTaskNameItem();var k=null;if(e)k=this.createTreeImg();this.cTaskNameItem.push(j);this.cTaskNameItem.push(k)}this.addDayInPanelTime();return this};GanttTask.prototype.createTreeImg=function(){var a=this;var b=new Image();b.src=this.Chart.imgs+"minus.gif";b.id=this.TaskInfo.Id;b.onclick=function(){if(a._isOpen){this.src=a.Chart.imgs+"plus.gif";a._isOpen=false;a.hideChildTasks(a);a.shiftCurrentTasks(a,-a._heightHideTasks)}else{this.src=a.Chart.imgs+"minus.gif";a._isOpen=true;a.shiftCurrentTasks(a,a._heightHideTasks);a.showChildTasks(a,true);a._heightHideTasks=0}};this.Chart.panelNames.firstChild.appendChild(b);b.style.cssText="cursor:pointer;left:"+(parseInt(this.cTaskNameItem[0].style.left)-12)+"px;top:"+(parseInt(this.cTaskNameItem[0].style.top)+3)+"px;z-index:12;position:absolute;";return b};GanttChart.prototype.getLastChildTask=function(a){if(a.childTask.length>0){return this.getLastChildTask(a.childTask[a.childTask.length-1])}else{return a}};dhtmlXMLSenderObject=function(a){this.xmlHttp=this.createXMLHttpRequest();this.isProcessed=false;this.path=null;this.filename=null;this.Chart=a};dhtmlXMLSenderObject.prototype.createXMLHttpRequest=function(){if(window.XMLHttpRequest){return new XMLHttpRequest()}else if(window.ActiveXObject){return new ActiveXObject("Microsoft.XMLHTTP")}};dhtmlXMLSenderObject.prototype.sendData=function(a,b,c){var d=this;this.path=b;this.filename=a;if((this.path==null)||(this.path=="")){this.Chart.Error.throwError("DATA_SEND_ERROR",3,null);return}if((this.filename==null)||(this.filename=="")){this.Chart.Error.throwError("DATA_SEND_ERROR",4,null);return}this.isProcessed=true;this.xmlHttp.open("POST",this.path,true);if(this.Chart._isFF){this.xmlHttp.onerror=function(){d.xmlHttp.onreadystatechange=null;d.xmlHttp.abort();d.isProcessed=false}}this.xmlHttp.onreadystatechange=function(){d.getStatus()};this.xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");this.xmlHttp.send("data="+encodeURI(c)+"&filename="+a)};dhtmlXMLSenderObject.prototype.getStatus=function(){if(this.xmlHttp.readyState==4){var a="";try{a=this.xmlHttp.status}catch(e){this.Chart.Error.throwError("DATA_SEND_ERROR",1,null);return 0}switch(a){case 0:this.Chart.Error.throwError("DATA_SEND_ERROR",1,null);break;case 404:this.Chart.Error.throwError("DATA_SEND_ERROR",5,[this.path]);break;case 500:this.Chart.Error.throwError("DATA_SEND_ERROR",2,null);break;case 12029:this.Chart.Error.throwError("DATA_SEND_ERROR",1,null);break;default:if(!(a>=200&&a<300||a==304)){this.Chart.Error.throwError("DATA_SEND_ERROR",0,null);}break}this.isProcessed=false}};function GanttError(){this.catches=[];this._errors=[];this._init();return this}GanttError.prototype._init=function(){this._errors[0]="Connection error";this._errors[1]="Cannot connect";this._errors[2]="Server error";this._errors[3]="Path is null or empty";this._errors[4]="Filename is null or empty";this._errors[5]="File (%0) is not found";this._errors[6]="Percent Complete  should be a number";this._errors[7]="Percent Complete should be <= 100";this._errors[8]="Percent Complete should be >= 0";this._errors[9]="Increase duration of task(%0)";this._errors[10]="Reduce duration of task(%0)";this._errors[11]="Increase  EST of child task (%0)";this._errors[12]="Reduce EST of task (%0)";this._errors[13]="The project (%0) is added";this._errors[14]="Start Date of the project < start Date of the control";this._errors[15]="Task (%0) cannot be the child of predecessor task(%1)";this._errors[16]="Time of the termination of predecessor task(%0) > EST of child task(%1)";this._errors[17]="The Predecessor (%0) task  does not exist";this._errors[18]="The EST of task (%0) < start date of the control";this._errors[19]="Time of the termination of parent task (%0) < time of the termination of child task(%1)";this._errors[20]="The EST of task (%0) < EST of parent task(%1)";this._errors[21]="The parent task (%0) does not exist";this._errors[22]="The task (%0) is added";this._errors[23]="The project (%0) is added";this._errors[24]="Task (%0) EST < project (%1) startDate";this._errors[25]="Parent task (%0) EST cannot be null";this._errors[26]="Predecessor task (%0) position error. Reduce duration of predecessor task (%0) or increase EST of child task (%1)";this._errors[27]="Predecessor task (%0) does not exist";this._errors[28]="Increase duration of parent task (%0) or reduce EST of child task (%1) or reduce duration of child task(%1)";this._errors[29]="Reduce EST of parent task (%0) or increase  EST of child task (%1)";this._errors[30]="The  task(%0) does not exist";this._errors[31]="The project(%0) does not exist";this._errors[32]="Predecessor task(%0) and child task(%1) should have the same parent";this._errors[33]="Reduce EST of parent task (%0) or increase  EST of child task (%1)";this._errors[34]="EST of task(%0) < start date of the project(%1)";this._errors[35]="Percent Complete should be <= 100 and >= 0";this._errors[36]="You may not connect a task to itself.";this._errors[37]="Cannot parse this XML string."};GanttError.prototype.catchError=function(a,b){this.catches[a]=b};GanttError.prototype.getErrorString=function(a,b){if(!b){return a}else{for(var i=0;i<b.length;i++){var c=new RegExp("%"+i,"gi");a=a.replace(c,b[i])}return a}};GanttError.prototype.throwError=function(a,b,c){if(this.catches[a]){var d=parseInt(b);var e=this.getErrorString(this._errors[d],c);return this.catches[a](a,e,c)}return null};function contextMenu(a){this.Chart=a;this.TabContainer=null;this.MenuPanel=null;this.tabPanel=null;this.arrTabs=[];this.isShow=false;this.hideDiv=null;this._init()}contextMenu.prototype._init=function(){this.createMenuPanel();this.createHideDiv();this.createTabContainer();this.createTabPanel();var k=this;var l=[];var m=this.createTab(1,"Rename task","t",true,this);m.addItem(1,"New name",document.createElement("input"),"text",function(){m.arrItems[0].control.focus()});m.addItem(2,"Rename",document.createElement("input"),"button",function(){var a=m.arrItems[0].control.value;try{m.object.setName(a);m.hide()}catch(e){}});var n=this.createTab(2,"Delete task","t",true,this);n.addItem(1,"Delete",document.createElement("input"),"button",function(){try{n.object.Project.deleteTask(n.object.TaskInfo.Id);n.hide()}catch(e){}});var o=this.createTab(3,"Set EST","t",true,this);o.addItem(1,"EST",document.createElement("input"),"text",function(){o.arrItems[0].control.focus()});o.addItem(2,"Move children",document.createElement("input"),"checkbox",function(){o.arrItems[1].control.focus()});o.addItem(3,"Update",document.createElement("input"),"button",function(){var a=o.arrItems[1].control.checked;var b=o.arrItems[0].control.value.split(".");var c=(b.length<3)?null:(new Date(b[2],parseInt(b[1])-1,b[0]));try{if(o.object.setEST(c,a))o.hide()}catch(e){}});var q=this.createTab(4,"Set duration","t",true,this);q.addItem(1,"Duration",document.createElement("input"),"text",function(){q.arrItems[0].control.focus()});q.addItem(2,"Update",document.createElement("input"),"button",function(){var d=q.arrItems[0].control.value;try{if(q.object.setDuration(d))q.hide()}catch(e){}});var r=this.createTab(5,"Set % complete","t",true,this);r.addItem(1,"Percent Complete",document.createElement("input"),"text",function(){r.arrItems[0].control.focus()});r.addItem(2,"Update",document.createElement("input"),"button",function(){var p=r.arrItems[0].control.value;try{if(r.object.setPercentCompleted(p))r.hide()}catch(e){}});var s=this.createTab(13,"Set predecessor","t",true,this);s.addItem(1,"Predecessor",document.createElement("input"),"text",function(){s.arrItems[0].control.focus()});s.addItem(2,"Update",document.createElement("input"),"button",function(){var p=s.arrItems[0].control.value;try{if(s.object.setPredecessor(p))s.hide()}catch(e){}});var t=this.createTab(6,"Rename project","p",true,this);t.addItem(1,"New name",document.createElement("input"),"text",function(){t.arrItems[0].control.focus()});t.addItem(2,"Rename",document.createElement("input"),"button",function(){var a=t.arrItems[0].control.value;try{t.object.setName(a);t.hide()}catch(e){}});var u=this.createTab(7,"Delete project","p",true,this);u.addItem(1,"Delete",document.createElement("input"),"button",function(){try{u.object.Chart.deleteProject(u.object.Project.Id);u.hide()}catch(e){}});var v=this.createTab(8,"Set % complete","p",true,this);v.addItem(1,"Percent Complete",document.createElement("input"),"text",function(){v.arrItems[0].control.focus()});v.addItem(2,"Update",document.createElement("input"),"button",function(){var p=v.arrItems[0].control.value;try{if(v.object.setPercentCompleted(p))v.hide()}catch(e){}});var w=this.createTab(9,"Add new task","p",true,this);w.addItem(1,"Id",document.createElement("input"),"text",function(){w.arrItems[0].control.focus()});w.addItem(2,"Name",document.createElement("input"),"text",function(){w.arrItems[1].control.focus()});w.addItem(3,"EST",document.createElement("input"),"text",function(){w.arrItems[2].control.focus()});w.addItem(4,"Duration",document.createElement("input"),"text",function(){w.arrItems[3].control.focus()});w.addItem(5,"Percent complete",document.createElement("input"),"text",function(){w.arrItems[4].control.focus()});w.addItem(6,"Parent task id",document.createElement("input"),"text",function(){w.arrItems[5].control.focus()});w.addItem(7,"Pred task id",document.createElement("input"),"text",function(){w.arrItems[6].control.focus()});w.addItem(9,"Insert",document.createElement("input"),"button",function(){try{var a=w.arrItems[0].control.value;var b=w.arrItems[1].control.value;var c=w.arrItems[2].control.value.split(".");var d=(c.length<3)?null:(new Date(c[2],parseInt(c[1])-1,c[0]));var f=w.arrItems[3].control.value;var g=w.arrItems[4].control.value;var h=w.arrItems[5].control.value;var i=w.arrItems[6].control.value;if(w.object.insertTask(a,b,d,f,g,i,h))w.hide()}catch(e){}});var x=this.createTab(11,"Add successor task","t",true,this);x.addItem(1,"Id",document.createElement("input"),"text",function(){x.arrItems[0].control.focus()});x.addItem(2,"Name",document.createElement("input"),"text",function(){x.arrItems[1].control.focus()});x.addItem(3,"EST",document.createElement("input"),"text",function(){x.arrItems[2].control.focus()});x.addItem(4,"Duration",document.createElement("input"),"text",function(){x.arrItems[3].control.focus()});x.addItem(5,"Percent complete",document.createElement("input"),"text",function(){x.arrItems[4].control.focus()});x.addItem(6,"Insert",document.createElement("input"),"button",function(){try{var a=x.object.Project;var b=x.arrItems[0].control.value;var c=x.arrItems[1].control.value;var d=x.arrItems[2].control.value.split(".");var f=(d.length<3)?null:(new Date(d[2],parseInt(d[1])-1,d[0]));var g=x.arrItems[3].control.value;var h=x.arrItems[4].control.value;var i=(x.object.parentTask==null)?"":x.object.parentTask.TaskInfo.Id;var j=x.object.TaskInfo.Id;if(a.insertTask(b,c,f,g,h,j,i))x.hide()}catch(e){}});var y=this.createTab(10,"Add child task","t",true,this);y.addItem(1,"Id",document.createElement("input"),"text",function(){y.arrItems[0].control.focus()});y.addItem(2,"Name",document.createElement("input"),"text",function(){y.arrItems[1].control.focus()});y.addItem(3,"EST",document.createElement("input"),"text",function(){y.arrItems[2].control.focus()});y.addItem(4,"Duration",document.createElement("input"),"text",function(){y.arrItems[3].control.focus()});y.addItem(5,"Percent complete",document.createElement("input"),"text",function(){y.arrItems[4].control.focus()});y.addItem(6,"Insert",document.createElement("input"),"button",function(){try{var a=y.object.Project;var b=y.arrItems[0].control.value;var c=y.arrItems[1].control.value;var d=y.arrItems[2].control.value.split(".");var f=(d.length<3)?null:(new Date(d[2],parseInt(d[1])-1,d[0]));var g=y.arrItems[3].control.value;var h=y.arrItems[4].control.value;var i=y.object.TaskInfo.Id;var j="";if(a.insertTask(b,c,f,g,h,j,i))y.hide()}catch(e){}});var z=this.createTab(12,"-Insert new project-","p",false,this);z.addItem(1,"Id",document.createElement("input"),"text",function(){z.arrItems[0].control.focus()});z.addItem(2,"Name",document.createElement("input"),"text",function(){z.arrItems[1].control.focus()});z.addItem(3,"Start date",document.createElement("input"),"text",function(){z.arrItems[2].control.focus()});z.addItem(4,"Insert",document.createElement("input"),"button",function(){try{var a=z.arrItems[0].control.value;var b=z.arrItems[1].control.value;var c=z.arrItems[2].control.value.split(".");var d=(c.length<3)?null:(new Date(c[2],parseInt(c[1])-1,c[0]));if(k.Chart.insertProject(a,b,d))z.hide()}catch(e){}})};contextMenu.prototype.createHideDiv=function(){this.hideDiv=document.createElement("div");this.hideDiv.style.position="absolute";this.hideDiv.style.left="0px";this.hideDiv.style.top="0px";this.Chart.content.appendChild(this.hideDiv);this.hideDiv.style.zIndex=12;this.hideDiv.style.display="none";this.hideDiv.style.background="#7D7E7D";this.hideDiv.style.cssText+=";-moz-opacity: 0.5;filter: alpha(opacity=50);opacity:.50;";this.hideDiv.style.width=this.Chart.content.offsetWidth+2+"px";this.hideDiv.style.height=this.Chart.content.offsetHeight+2+"px"};contextMenu.prototype.createMenuPanel=function(){this.MenuPanel=document.createElement("div");this.MenuPanel.style.visibility="hidden";this.MenuPanel.style.cssText+=";z-index:10;";this.MenuPanel.style.position="absolute";this.Chart.content.appendChild(this.MenuPanel);this.MenuPanel.innerHTML="<table></table>";this.MenuPanel.firstChild.className="contextMenu";this.MenuPanel.firstChild.cellPadding=0;this.MenuPanel.firstChild.cellSpacing=0;this.MenuPanel.firstChild.style.cssText+=";background:url("+this.Chart.imgs+"menu/menu_bg.png);"};contextMenu.prototype.createTabPanel=function(){this.tabPanel=document.createElement("div");this.tabPanel.style.visibility="hidden";this.tabPanel.style.zIndex="30";this.TabContainer.firstChild.rows[0].cells[0].appendChild(this.tabPanel);this.tabPanel.style.width="385px";this.tabPanel.style.height="290px";this.tabPanel.innerHTML="<table><tr><td></td></tr><tr><td></td></tr></table>";this.tabPanel.firstChild.cellPadding=0;this.tabPanel.firstChild.cellSpacing=0;this.tabPanel.firstChild.style.cssText="width:385px;border: 1px solid #808080;";this.tabPanel.firstChild.rows[0].cells[0].style.cssText=";height:26px;background:url("+this.Chart.imgs+"/menu/window_tr.png);background-repeat: no-repeat;color:#fff;font-size:14px;font-weight: bold;font-family: Tahoma, Arial";this.tabPanel.firstChild.rows[0].cells[0].align="center";this.tabPanel.firstChild.rows[1].cells[0].style.cssText=";height:270px;background:#F7F7F7;";this.tabPanel.firstChild.rows[1].cells[0].innerHTML="<table></table>";this.tabPanel.firstChild.rows[1].cells[0].firstChild.style.cssText="width:250px;font-size:11px;font-family:Tahoma,Arial;";this.tabPanel.firstChild.rows[1].cells[0].align="center"};contextMenu.prototype.addItemMenuPanel=function(a){var b=this;var c=this.MenuPanel.firstChild.insertRow(this.MenuPanel.firstChild.rows.length);var d=document.createElement('td');d.innerHTML=a.Description;d.style.cssText="padding-left:10px;height:18px;";this.addEvent(d,"mousedown",function(){a.show()},false);d.onmouseover=function(){this.style.background="url("+b.Chart.imgs+"menu/menu_selection.png)"};d.onmouseout=function(){this.style.background=""};c.appendChild(d)};contextMenu.prototype.showContextMenu=function(x,y,a){if(a.constructor==GanttTask){for(var i=0;i<this.arrTabs.length;i++){if(this.arrTabs[i].type=="t"){this.arrTabs[i].object=a;this.addItemMenuPanel(this.arrTabs[i])}}}else if(a.constructor==GanttProject){for(var i=0;i<this.arrTabs.length;i++){if(this.arrTabs[i].type=="p"){this.arrTabs[i].object=a;this.addItemMenuPanel(this.arrTabs[i])}}}this.isShow=true;this.MenuPanel.style.cssText+=";z-index:15;";this.MenuPanel.style.visibility="visible";this.MenuPanel.style.top=parseInt(y)+this.Chart.heightTaskItem-this.Chart.oData.scrollTop+5+"px";this.MenuPanel.style.left=x};contextMenu.prototype.hideContextMenu=function(){this.isShow=false;this.MenuPanel.style.visibility="hidden"};contextMenu.prototype.clear=function(){this.MenuPanel.removeChild(this.MenuPanel.firstChild);this.MenuPanel.innerHTML="<table></table>";this.MenuPanel.firstChild.className="contextMenu";this.MenuPanel.firstChild.cellPadding=0;this.MenuPanel.firstChild.cellSpacing=0;this.MenuPanel.firstChild.style.cssText+=";background:url("+this.Chart.imgs+"menu/menu_bg.png);"};contextMenu.prototype.createTab=function(a,b,c,d,e){var f=new contextMenuTab(a,b,c,d,e);this.arrTabs.push(f);return f};contextMenu.prototype.createTabContainer=function(){this.TabContainer=document.createElement("div");this.TabContainer.style.position="absolute";this.TabContainer.style.top="0px";this.TabContainer.style.left="0px";this.TabContainer.style.visibility="hidden";this.TabContainer.style.zIndex="50";this.Chart.content.appendChild(this.TabContainer);this.TabContainer.innerHTML="<table><tr><td></td></tr></table>";this.TabContainer.firstChild.style.cssText=";width:100%;height:100%;";this.TabContainer.firstChild.rows[0].cells[0].align="center";this.TabContainer.style.width=this.Chart.content.offsetWidth+2+"px";this.TabContainer.style.height=this.Chart.content.offsetHeight+2+"px"};contextMenu.prototype.getTabById=function(a){for(var i=0;i<this.arrTabs.length;i++){if(this.arrTabs[i].Id==a){return this.arrTabs[i]}}return null};function contextMenuTab(a,b,c,d,e){this.Id=a;this.arrItems=[];this.TabItemContainer=null;this.Description=b;this.contextMenu=e;this.type=c;this.object=null;this.showObjectInfo=d}contextMenu.prototype.addEvent=function(a,b,c,d){if(a.addEventListener){a.addEventListener(b,c,d);return true}else if(a.attachEvent){return a.attachEvent('on'+b,c)}else{a['on'+b]=c}};contextMenuTab.prototype.addItem=function(a,b,c,d,e){if(e){c.onclick=e}c.type=d;if(d=="button"){c.value=b}var f=new contextMenuTabItem(a,b,c,this);this.arrItems.push(f)};contextMenuTab.prototype.show=function(){this.contextMenu.hideDiv.style.display="inline";this.contextMenu.TabContainer.style.visibility="visible";var a=this;this.contextMenu.tabPanel.firstChild.rows[0].cells[0].innerHTML=this.Description;this.contextMenu.tabPanel.style.visibility="visible";var t=this.contextMenu.tabPanel.firstChild.rows[1].cells[0].firstChild;var c,c2,r=null;if(this.showObjectInfo){if(this.object){if(this.object.constructor==GanttTask){this.insertData(t,"Id",this.object.TaskInfo.Id);this.insertData(t,"Name",this.object.TaskInfo.Name);this.insertData(t,"Duration",this.object.TaskInfo.Duration+" hrs");this.insertData(t,"Percent complete",this.object.TaskInfo.PercentCompleted+"%");this.insertData(t,"Start Date",(this.object.TaskInfo.EST.getMonth()+1)+"."+this.object.TaskInfo.EST.getDate()+"."+this.object.TaskInfo.EST.getFullYear());this.insertData(t,"Predecessor",this.object.TaskInfo.PredecessorTaskId)}else{this.insertData(t,"Id",this.object.Project.Id);this.insertData(t,"Name",this.object.Project.Name);this.insertData(t,"Start date",(this.object.Project.StartDate.getMonth()+1)+"."+this.object.Project.StartDate.getDate()+"."+this.object.Project.StartDate.getFullYear())}}}var d=null;for(var i=0;i<this.arrItems.length;i++){if(this.arrItems[i].control.type=="button"){r=t.insertRow(t.rows.length);c=r.insertCell(r.cells.length);d=r.insertCell(r.cells.length);d.appendChild(this.arrItems[i].control)}else{r=t.insertRow(t.rows.length);c=r.insertCell(r.cells.length);c2=r.insertCell(r.cells.length);c.innerHTML=this.arrItems[i].Name;c2.appendChild(this.arrItems[i].control)}}var b=document.createElement("input");b.type="button";b.value="Cancel";b.onclick=function(){a.hide()};if(!d){r=t.insertRow(t.rows.length);c=r.insertCell(r.cells.length);d=r.insertCell(r.cells.length)}else{b.style.marginLeft="10px"}d.appendChild(b)};contextMenuTab.prototype.hide=function(){this.contextMenu.tabPanel.style.visibility="hidden";var t=this.contextMenu.tabPanel.firstChild.rows[1].cells[0].firstChild;t.parentNode.removeChild(t);this.contextMenu.tabPanel.firstChild.rows[1].cells[0].innerHTML="<table></table>";this.contextMenu.tabPanel.firstChild.rows[1].cells[0].firstChild.style.cssText="width:250px;font-size:11px;font-family:Tahoma,Arial;";this.contextMenu.hideDiv.style.display="none";this.contextMenu.TabContainer.style.visibility="hidden"};contextMenuTab.prototype.insertData=function(t,a,b){var c,c2,r=null;r=t.insertRow(t.rows.length);c=r.insertCell(r.cells.length);c.style.cssText="width:100px";c.innerHTML=a;c2=r.insertCell(r.cells.length);c2.innerHTML=b};contextMenuTab.prototype.insertControl=function(t,a,b){var c,c2,r=null;r=t.insertRow(t.rows.length);c=r.insertCell(r.cells.length);c.innerHTML=a;c2=r.insertCell(r.cells.length);c2.appendChild(b)};function contextMenuTabItem(a,b,c,d){this.Id=a;this.Name=b;this.control=c;this.tab=d}