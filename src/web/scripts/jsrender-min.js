(function(e,t,n){"use strict";function H(e,t){if(t&&t.onError){if(t.onError(e)===p){return}}this.name="JsRender Error";this.message=e||"JsRender error"}function B(e,t){var n;e=e||{};for(n in t){e[n]=t[n]}return e}function j(e,t,n){if(!ut.rTag||arguments.length){a=e?e.charAt(0):a;f=e?e.charAt(1):f;l=t?t.charAt(0):l;c=t?t.charAt(1):c;h=n||h;e="\\"+a+"(\\"+h+")?\\"+f;t="\\"+l+"\\"+c;o="(?:(?:(\\w+(?=[\\/\\s\\"+l+"]))|(?:(\\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\\*)))"+"\\s*((?:[^\\"+l+"]|\\"+l+"(?!\\"+c+"))*?)";ut.rTag=o+")";o=new RegExp(e+o+"(\\/)?|(?:\\/(\\w+)))"+t,"g");u=new RegExp("<.*>|([^\\\\]|^)[{}]|"+e+".*"+t)}return[a,f,l,c,h]}function F(e,t){if(!t){t=e;e=n}var r,i,s,o,u=this,a=!t||t==="root";if(e){o=u.type===t?u:n;if(!o){r=u.views;if(u._.useKey){for(i in r){if(o=r[i].get(e,t)){break}}}else for(i=0,s=r.length;!o&&i<s;i++){o=r[i].get(e,t)}}}else if(a){while(u.parent.parent){o=u=u.parent}}else while(u&&!o){o=u.type===t?u:n;u=u.parent}return o}function I(){var e=this.get("item");return e?e.index:n}function q(e){var t,r=this,i=(r.ctx||{})[e];i=i===n?r.getRsc("helpers",e):i;if(i){if(typeof i==="function"){t=function(){return i.apply(r,arguments)};B(t,i)}}return t||i}function R(e,t,n,r,i,s){if(e||i){var o,u=!n.markup&&n,a={_:{inline:!u},tagName:e+":",tagCtx:r,flow:d,_is:"tag"},f=r.args=M.call(arguments,5);r.view=t;r.bind=!!(u||i);if(u){u.tag=a;a.linkCtx=u;r.ctx=nt(r.ctx,u.view.ctx)}a.ctx=r.ctx||{};r.props=r.props||{};delete r.ctx;e=e!=="true"&&e;if(e&&((o=t.getRsc("converters",e))||G("Unknown converter: {{"+e+":"))){s=o.apply(a,f)}if(i){i=t.tmpl.bnds[i-1];u.paths=i;t._.tag=a;s=t._.onRender(s,t,d)}}return s}function U(e,t){var r,i=this,s=P[e];r=s&&s[t];while(r===n&&i){s=i.tmpl[e];r=s&&s[t];i=i.parent}return r}function z(e,t,r,i,s,o){var u,a,f,l,c,h,d,v=r.markup&&r,m=!v&&r,g=t._,y=v||t.tmpl,b=t.getRsc("tags",e)||G("Unknown tag: {{"+e+"}}"),w=s.args=arguments.length>6?M.call(arguments,6):[],E=s.props=s.props||{};s.view=t;s.ctx=nt(s.ctx,t.ctx);f=s.ctx||{};delete s.ctx;v=E.tmpl;i=i&&y.tmpls[i-1];v=v||i||b.template||n;v=""+v===v?t.getRsc("templates",v)||rt(v):v;if(e==="else"){c=t._.tag;l=c._.elses=c._.elses||[];l.push(v);s.isElse=l.length;a=c.render}c=c||m.tag;if(!c){if(b.init){c=new b.init(s,m,f);c.attr=c.attr||b.attr||n}else{c={render:b.render,renderContent:Q}}c._={parentTag:f.tag,tmpl:v,inline:!m};if(m){m.attr=c.attr=m.attr||c.attr}}if(!c.flow){h=f.tags=t.ctx&&nt(f.tags,t.ctx.tags)||{};f.tag=h[e]=c}c.tagCtx=s;c.tagName=e;c.ctx=f;c._is="tag";c._.done=s.isElse?c._.done:p;v=v||c._.tmpl;l=c._.elses;g.tag=c;if(m){m.tag=c;c.linkCtx=m}if(a=a||c.render){u=a.apply(c,w)}u=u!==n?u:v?c.renderContent():"";if(c._.inline&&(d=c.attr)&&d!=="html"){u=d==="text"?it.html(u):""}return o&&g.onRender?g.onRender(u,t,o):u}function W(e,t,r,i,s,o,u){var a,f,l=t==="array",c={key:0,useKey:l?0:1,id:""+k++,onRender:u,bnd:{}},h={data:i,tmpl:s,views:l?[]:{},parent:r,ctx:e,type:t,get:F,getIndex:I,getRsc:U,hlp:q,_:c};if(r){a=r.views;f=r._;if(f.useKey){a[c.key="_"+f.useKey++]=h}else{a.splice(c.key=h.index=o!==n?o:a.length,0,h)}h.ctx=e||r.ctx}return h}function X(e){var t,n,r,i,s;for(t in D){i=D[t];if((s=i.compile)&&(n=e[t+"s"])){for(r in n){n[r]=s(r,n[r],e,t,i)}}}}function V(e,t,n){var r,i;if(typeof t==="function"){t={depends:t.depends,render:t}}else{if(i=t.template){t.template=""+i===i?rt[i]||rt(i):i}if(t.init!==p){r=t.init=t.init||function(e){};r.prototype=t;(r.prototype=t).constructor=r}}t.renderContent=Q;if(n){t._parentTmpl=n}return t}function $(r,i,s,o,a,f){function l(n){if(""+n===n||n.nodeType>0){try{h=n.nodeType>0?n:!u.test(n)&&t&&t(e.document).find(n)[0]}catch(i){}if(h){n=h.getAttribute(A);r=r||n;n=rt[n];if(!n){r=r||"_"+C++;h.setAttribute(A,r);n=rt[r]=$(r,h.innerHTML,s,o,a,f)}}return n}}var c,h;i=i||"";c=l(i);f=f||(i.markup?i:{});f.tmplName=r;if(s){f._parentTmpl=s}if(!c&&i.markup&&(c=l(i.markup))){if(c.fn&&(c.debug!==i.debug||c.allowCode!==i.allowCode)){c=c.markup}}if(c!==n){if(r&&!s){_[r]=function(){return i.render.apply(i,arguments)}}if(c.fn||i.fn){if(c.fn){if(r&&r!==c.tmplName){i=nt(f,c)}else{i=c}}}else{i=J(c,f);Z(c,i)}X(f);return i}}function J(e,t){var n,r=at.wrapMap||{},s=B({markup:e,tmpls:[],links:{},bnds:[],render:Q},t);if(!t.htmlTag){n=S.exec(e);s.htmlTag=n?n[1].toLowerCase():""}n=r[s.htmlTag];if(n&&n!==r.div){s.markup=i.trim(s.markup);s._elCnt=d}return s}function K(e,t){function r(s,o,u){var a,f,l,c;if(s&&""+s!==s&&!s.nodeType&&!s.markup){for(l in s){r(l,s[l],o)}return P}c=u?u[i]=u[i]||{}:r;if(o===n){o=s;s=n}f=t.compile;if(a=ut.onBeforeStoreItem){f=a(c,s,o,f)||f}if(!s){o=f(n,o)}else if(""+s===s){if(o===null){delete c[s]}else{c[s]=f?o=f(s,o,u,e,t):o}}if(o){o._is=e}if(a=ut.onStoreItem){a(c,s,o,f)}return o}var i=e+"s";P[i]=r;D[e]=t}function Q(e,t,r,s,o,u){var a,f,l,c,h,v,m,g,y,b,w,E,S=this,x=S,T=!S.attr||S.attr==="html",N="";if(s===d){g=d;s=0}if(S._is==="tag"){b=S._;E=S.tagName;y=S.tagCtx;x=y.isElse?b.elses[y.isElse-1]:b.tmpl;t=nt(t,S.ctx);m=y.props;if(m.link===p){t=t||{};t.link=p}r=r||y.view;e=e===n?r:e}else{x=S.jquery&&(S[0]||G('Unknown template: "'+S.selector+'"'))||S}if(x){if(r){u=u||r._.onRender;if(e===r){e=r.data;o=d}t=nt(t,r.ctx)}else{(t=t||{}).root=e}if(!x.fn){x=rt[x]||rt(x)}if(x){u=(t&&t.link)!==p&&T&&u;w=u;if(u===d){w=n;u=r._.onRender}if(i.isArray(e)&&!o){c=g?r:s!==n&&r||W(t,"array",r,e,x,s,u);for(a=0,f=e.length;a<f;a++){l=e[a];h=W(t,"item",c,l,x,(s||0)+a,u);v=x.fn(l,h,P);N+=c._.onRender?c._.onRender(v,h):v}}else{c=g?r:W(t,E||"data",r,e,x,s,u);if(b&&!S.flow){c.tag=S}N+=x.fn(e,c,P)}return w?w(N,c):N}}return""}function G(e){if(at.debugMode){throw new P.sub.Error(e)}}function Y(e){G("Syntax error\n"+e)}function Z(e,t,n,r){function i(t){t-=c;if(t){p.push(e.substr(c,t).replace(g,"\\n"))}}function s(t){t&&Y('Unmatched or missing tag: "{{/'+t+'}}" in template:\n'+e)}function u(t,o,u,l,m,g,b,S,x,T,N,C){if(g){m=":";l="html"}var k,L,A=[],O="",M="",_="",D=!T&&!m&&!b&&!n;u=u||m;i(C);c=C+t.length;if(S){if(f){p.push(["*","\n"+x.replace(y,"$1")+"\n"])}}else if(u){if(u==="else"){if(E.test(x)){Y('for "{{else if expr}}" use "{{else expr}}"')}v[7]=e.substring(v[7],C);v=h.pop();p=v[3];D=d}if(x){x=x.replace(/\s*\n\s*/g," ");O=tt(x,A).replace(w,function(e,t,n){if(t){_+=n+","}else{M+=n+","}return""})}M=M.slice(0,-1);O=O.slice(0,-1);k=M&&M.indexOf("noerror:true")+1&&M||"";a=[u,l||!!r||"",O,D&&[],"{"+(M?"props:"+(k?"hsh":"{"+M+"}")+",":"")+'params:"'+x+'"'+(_?",ctx:{"+_.slice(0,-1)+"}":"")+"},",k,o&&A||0];p.push(a);if(D){h.push(v);v=a;v[7]=c}}else if(N){L=v[0];s(N!==L&&L&&L!=="else");v[7]=e.substring(v[7],C);v=h.pop()}s(!v&&N);p=v[3]}var a,f=t&&t.allowCode,l=[],c=0,h=[],p=l,v=[,,,l];e=e.replace(b,"\\$1");s(h[0]&&h[0][3].pop()[0]);e.replace(o,u);i(e.length);if(c=l[l.length-1]){s(""+c!==c&&+c[7]===c[7]&&c[0])}return et(l,t)}function et(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,v,m,g,y,b,w,E,S,x="",T={},N=e.length;if(t){if(w=t.allowCode){T.allowCode=d}if(t.debug){T.debug=d}m=t.bnds;y=t.tmpls}for(r=0;r<N;r++){i=e[r];n="";if(""+i===i){n='ret+="'+i+'";'}else{c=i[0];if(c==="*"){n=""+i[1]}else{h=i[1];p=i[2];E=i[3];v=i[4];o=i[5];g=i[6];S=i[7];if(E){b=J(S,T);et(E,b);y.push(b)}if(g){m.push(g);g=m.length}l=l||v.indexOf("view")>-1;if(o){o="try{prm="+p+";hsh={"+o+'};}catch(e){prm="";hsh={};}\n';p="prm"}n+=o+"ret+="+(c===":"?h==="html"&&!g?(u=d,"h("+p+");"):h||g?(f=d,'c("'+h+'",view,this,'+v+g+","+p+");"):(a=d,"(v="+p+')!=u?v:"";'):(s=d,'t("'+c+'",view,this,'+(E?y.length:'""')+","+v+g+(p?",":"")+p)+");")}}x+="\n"+n}x=O+(o?"prm,hsh,":"")+(a?"v,":"")+(s?"t=j._tag,":"")+(f?"c=j._cnvt,":"")+(u?"h=j.converters.html,":"")+'ret="";\n'+(at.tryCatch?"try{\n":"")+(T.debug?"debugger;":"")+x+"\nreturn ret;\n"+(at.tryCatch?"\n}catch(e){return j._err(e);}":"");try{x=new Function("data, view, j, u",x)}catch(C){Y("Compiled template code:\n\n"+x,C)}if(t){t.fn=x}return x}function tt(e,t){function n(n,a,f,l,c,h,m,g,y,b,w,E,S,x,T,N){function C(e,n,r,i,s,o,u){if(n){t.push(l);if(n!=="."){var a,f=(r?'view.hlp("'+r+'")':i?"view":"data")+(u?(s?"."+s:r?"":i?"":"."+n)+(o||""):(u=r?"":i?s||"":n,""));a=u?"."+u:"";f=f+a;f=f.slice(0,9)==="view.data"?f.slice(5):f;return f}}return e}c=c||"";f=f||a||w;l=l||g;y=y||T||"";if(h){Y(e)}else{return u?(u=!E,u?n:'"'):o?(o=!S,o?n:'"'):(f?(s++,f):"")+(N?s?"":r?(r=p,"\b"):",":m?(s&&Y(e),r=d,"\b"+l+":"):l?l.split("^").join(".").replace(v,C)+(y?(i[++s]=d,y):c):c?c:x?(i[s--]=p,x)+(y?(i[++s]=d,y):""):b?(i[s]||Y(e),","):a?"":(u=E,o=S,'"'))}}var r,i={},s=0,o=p,u=p;t.expr=e.replace(y,"$1");return(e+" ").replace(m,n)}function nt(e,t){return e&&e!==t?t?B(B({},t),e):e:t&&B({},t)}function ft(e){return L[e]}if(t&&t.views||e.jsviews){return}var r="v1.0pre",i,s,o,u,a="{",f="{",l="}",c="}",h="^",p=false,d=true,v=/^(?:null|true|false|\d[\d.]*|([\w$]+|\.|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,m=/(\()(?=|\s*\()|(?:([([])\s*)?(?:([#~]?[\w$.^]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*!:?\/]|(=))\s*|([#~]?[\w$.^]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*([)\]])([([]?))|(\s+)/g,g=/\r?\n/g,y=/\\(['"])/g,b=/([\\'"])/g,w=/\x08(~)?([^\x08]+)\x08/g,E=/^if\s/,S=/<(\w+)[>\s]/,x=/<(\w+)[^>\/]*>[^>]*$/,T=/[<"'&]/g,N=/[\x00<>"'&]/g,C=0,k=0,L={"&":"&","<":"<",">":">","\0":"&#0;","'":"&#39;",'"':"&#34;"},A="data-jsv-tmpl",O="var j=j||"+(t?"jQuery.":"js")+"views,",M=[].slice,_={},D={template:{compile:$},tag:{compile:V},helper:{},converter:{}},P={jsviews:r,render:_,View:W,settings:{delimiters:j,debugMode:d,tryCatch:d},sub:{Error:H,tmplFn:Z,parse:tt,extend:B,error:G,syntaxError:Y},_cnvt:R,_tag:z,_err:function(e){return at.debugMode?"Error: "+(e.message||e)+". ":""}};(H.prototype=new Error).constructor=H;I.depends=function(e){return[e.get("item"),"index"]};for(s in D){K(s,D[s])}var rt=P.templates,it=P.converters,st=P.helpers,ot=P.tags,ut=P.sub,at=P.settings;if(t){i=t;i.render=_;i.views=P;i.templates=rt=P.templates;i.fn.render=Q}else{i=e.jsviews=P;i.isArray=Array&&Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"}}ot({"if":{render:function(e){var t=this;return t._.done||arguments.length&&!e?"":(t._.done=true,t.renderContent())},flow:d},"else":function(){},"for":{render:function(){var e,t,r=this,s=r.tagCtx,o="",u=arguments,a=0,f=u.length;if(!f){return s.done?"":(s.done=d,r.renderContent())}for(e=0;e<f;e++){t=u[e];if(t===n){return""}else{a+=i.isArray(t)?t.length:1;o+=r.renderContent(t)}}s.done=a;return o},flow:d},"*":{render:function(e){return e},flow:d}});it({html:function(e){return e!=n?String(e).replace(N,ft):""},attr:function(e){return e!=n?String(e).replace(T,ft):""},url:function(e){return e!=n?encodeURI(String(e)):""}});j()})(this,this.jQuery)